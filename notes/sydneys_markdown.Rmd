---
title: "sydneys_markdown"
output: html_document
date: "2025-07-14"
---

```{r}
#Authors: [Sydney S]
#Date: 07/09/2025
#Purpose: The purpose of this notebook is to house all data set transformation, cleansing, visualization, statistical analysis, and note-taking for the 2025 CU Athletic Department Sports Science Internship Program

#LAST UPDATED: 07/23/2025

#Including helpful libraries
library(tidyverse)
library(readxl)
library(aod)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(readr)
```

#Loading Datasets
```{r}
#Womens basketball datasets
#Incident_B <- read.csv("data-sets/Incident Report WBB.csv")
#Dynamo_B <- read.csv("data-sets/VALD - Dynamo WBB.csv")
#Forcedecks_B <- read.csv("data-sets/VALD - ForceDecks WBB.csv")
#Performance_B <- read.csv("data-sets/VALD - Performance Test WBB.csv")

#womens soccer datasets
#Incident_S <- read.csv("data-sets/Incident Report WSOC.csv")
#Dynamo_S <- read.csv("data-sets/VALD - Dynamo WSOC.csv")
#Forcedecks_S <- read.csv("data-sets/VALD - ForceDecks WSOC.csv")
#Performance_S <- read.csv("data-sets/VALD - Performance Test WSOC.csv")

#womens lacrosse datasets
#Incident_L <- read.csv("data-sets/Incident Report WLAX.csv")
#Dynamo_L <- read.csv("data-sets/VALD - Dynamo WLAX.csv")
#Forcedecks_L <- read.csv("data-sets/VALD - ForceDecks WLAX.csv")
#Performance_L <- read.csv("data-sets/VALD - Performance Test WLAx (1).csv")

#womens volleyball datasets 
#Incident_V <- read.csv("data-sets/Incident Report WVB.csv")
#Dynamo_V <- read.csv("data-sets/VALD - Dynamo WVB.csv")
#Forcedecks_L <- read.csv("data-sets/VALD - ForceDecks WVB.csv")
#Performance_V <- read.csv("data-sets/VALD - Performance Test WVB.csv")
```

```{r}
#copied as paths above were not working rn
#INCIDENT DATASETS
Incident_B <- read.csv("~/T2P2-data-analysis-2025/data-sets/Incident Report WBB.csv")
Incident_S <- read.csv("~/T2P2-data-analysis-2025/data-sets/Incident Report WSOC.csv")
Incident_L <- read.csv("~/T2P2-data-analysis-2025/data-sets/Incident Report WLAX.csv")
Incident_V <- read.csv("~/T2P2-data-analysis-2025/data-sets/Incident Report WVB.csv")
```

#Data Cleaning
-no risk status watchlist to compare to, just look at actual incidents 

1. Incident Datasets
```{r}
#BASKETBALL Incident dataset
Incident_B <- Incident_B %>%                    #189 -> 128 obs.
filter(Incident.Type=="Injury") %>%
filter(Status %in% c("Out", "As Tolerated")) %>%
filter(Result.of.Sport.Participation=="Yes")  %>%
select(-Result.of.Sport.Participation)

incident_B <- subset(Incident_B,select=c("anon_id","Date","Sport", "Position", "Date.of.Injury...Onset.of.symptoms", "Side", "Body.Part.","Total.Time.Injured", "Tissue.Type","OSICS14.Code","OSICS10.Diagnosis","Final.Diagnosis", "Recurrence.of.Injury", "Injury.Prognosis", "General.mechanism","Specific.Mechanism","Injured.Position", "Month", "Year","Status","Season.","Start.of.Status", "End.Date", "Total.Time.Injured"))  #add,"Injured.Position",
        #53 obs. + 27 vars.

#Lower body injuries 
lower_body <- c("Thigh","Ankle","Lower leg","Knee","Foot","Groin/hip")
incident_B$LB.Injury <- ifelse(incident_B$Body.Part. %in% c("Thigh", "Ankle", "Lower leg", "Knee", "Foot", "Groin/hip"),1,0) #lower body Injury Binary
sum(incident_B$LB.Injury)

#ACL injury (most intense LB injury)
incident_B$ACL <- ifelse(incident_B$OSICS14.Code %in% c("KL1","KLA"),1,0)
sum(incident_B$ACL)
#HSI injury (overuse injury)
incident_B$HSI <- ifelse(incident_B$OSICS14.Code %in% c("TM1","TMB","TMS"),1,0)
sum(incident_B$HSI)

#12/5/23-1/2/25 DATE RANGE (2 years)

#converting all dates
incident_b <- incident_B %>%
mutate(Total.Time.Injured = sum(Total.Time.Injured, na.rm = TRUE),
       Date = as.Date(Date, format = '%m/%d/%Y'),
       Start.of.Status=as.Date(Start.of.Status,format='%m/%d/%Y'),
       End.Date= as.Date(End.Date, format='%m/%d/%Y'),
       Date.of.Injury...Onset.of.symptoms= as.Date(Date.of.Injury...Onset.of.symptoms, format='%m/%d/%Y'))

#create a length of status variable (Out, limited,as tolerated, full go)
incident_b$Length.of.Status <- difftime(incident_b$End.Date, incident_b$Start.of.Status,units=c("days"))

library(stringr)
#rename one datapoint from position
incident_b <- incident_b %>%
  mutate(Position=case_when(
    str_detect(Position, "Primary: Forward")~ "Forward",
    str_detect(Position, "Forward")~ "Forward",
    str_detect(Position, "Center")~ "Center",
    str_detect(Position, "Guard")~ "Guard",
    TRUE~Position
  ))
#rename sport column to better compare when joining datasets
incident_b <- incident_b %>%
  mutate(Sport=case_when(
    str_detect(Sport, "Primary: BASKETBALL")~ "Basketball",
    str_detect(Sport, "BASKETBALL")~ "Basketball"
  ))
```
In womens basketball we have 42 total lower body injuries, 1 of those injuries are ACL injuries, and none are HSI injuries.

```{r}
#SOCCER INCIDENT dataset
Incident_S <- Incident_S %>%                    #361 -> 288 obs.
filter(Incident.Type=="Injury") %>%
filter(Status %in% c("Out", "As Tolerated")) %>%
filter(Result.of.Sport.Participation=="Yes") %>%
select(-Result.of.Sport.Participation)

incident_S <- subset(Incident_S,select=c("anon_id","Date","Sport", "Position", "Date.of.Injury...Onset.of.symptoms", "Side", "Body.Part.", "Total.Time.Injured", "Tissue.Type","OSICS14.Code","OSICS10.Diagnosis", "Final.Diagnosis", "Recurrence.of.Injury", "Injury.Prognosis", "General.mechanism","Specific.Mechanism","Injured.While.", "Month", "Year","Incident.Type","Status", "Season.","Start.of.Status", "End.Date"))
        #88 obs. + 27 vars.

#Lower body injuriy Binary
incident_S$LB.Injury <- ifelse(incident_S$Body.Part. %in% c("Thigh", "Ankle", "Lower leg", "Knee", "Foot", "Groin/hip"),1,0)
sum(incident_S$LB.Injury)

#ACL injury (most intense LB injury)
incident_S$ACL <- ifelse(incident_S$OSICS14.Code %in% c("KL1","KLA"),1,0)
sum(incident_S$ACL)
#HSI injury (overuse injury)
incident_S$HSI <- ifelse(incident_S$OSICS14.Code %in% c("TM1","TMB","TMS"),1,0)
sum(incident_S$HSI)

#5/8/23- 1/15/25 (year and a half ish)

#converting all dates
incident_s <- incident_S %>%
mutate(Total.Time.Injured = sum(Total.Time.Injured, na.rm = TRUE),
       Date = as.Date(Date, format = '%m/%d/%Y'),
       Start.of.Status=as.Date(Start.of.Status,format='%m/%d/%Y'),
       End.Date= as.Date(End.Date, format='%m/%d/%Y'),
       Date.of.Injury...Onset.of.symptoms= as.Date(Date.of.Injury...Onset.of.symptoms, format='%m/%d/%Y'),
       Sport=case_when(
    str_detect(Sport, "SOCCER")~ "Soccer"   #rename sport column to better compare when joining datasets
  ))

#create a length of status variable (Out, limited,as tolerated, full go)
incident_s$Length.of.Status <- difftime(incident_s$End.Date, incident_s$Start.of.Status,units=c("days"))
```
In women's soccer there is a total of 76 lower body injuries, with 1 of them being ACL injuries, and 2 being HSI injuries.

```{r}
#VOLLEYBALL incident dataset
Incident_V <- Incident_V %>%                    #220 -> 135 obs.
filter(Incident.Type=="Injury") %>%
filter(Status %in% c("Out", "As Tolerated")) %>%
filter(Result.of.Sport.Participation=="Yes") %>%
select(-Result.of.Sport.Participation)

incident_V <- subset(Incident_V,select=c("anon_id","Date","Sport", "Position", "Date.of.Injury...Onset.of.symptoms", "Side", "Body.Part.", "Total.Time.Injured", "Tissue.Type","OSICS14.Code","OSICS10.Diagnosis", "Final.Diagnosis", "Recurrence.of.Injury", "Injury.Prognosis", "General.mechanism","Specific.Mechanism","Injured.While.", "Month", "Year","Status", "Season.","Start.of.Status", "End.Date", "Total.Time.Injured"))
        #52 +23 vars.

#Lower body injury binary
incident_V$LB.Injury <- ifelse(incident_V$Body.Part. %in% c("Thigh", "Ankle", "Lower leg", "Knee", "Foot", "Groin/hip"),1,0)
sum(incident_V$LB.Injury)

#ACL injury (most intense LB injury)
incident_V$ACL <- ifelse(incident_V$OSICS14.Code %in% c("KL1","KLA"),1,0)
sum(incident_V$ACL)
#HSI injury (overuse injury)
incident_V$HSI <- ifelse(incident_V$OSICS14.Code %in% c("TM1","TMB","TMS"),1,0)
sum(incident_V$HSI)

#1/16/24-9/8/24 (9 MONTHS)

#converting all dates
incident_v <- incident_V %>%
mutate(Total.Time.Injured = sum(Total.Time.Injured, na.rm = TRUE),
       Date = as.Date(Date, format = '%m/%d/%Y'),
       Start.of.Status=as.Date(Start.of.Status,format='%m/%d/%Y'),
       End.Date= as.Date(End.Date, format='%m/%d/%Y'),
       Date.of.Injury...Onset.of.symptoms= as.Date(Date.of.Injury...Onset.of.symptoms, format='%m/%d/%Y'),
       Sport=case_when(
    str_detect(Sport, "VOLLEYBALL")~ "Volleyball"
  )
)

#create a length of status variable (Out, limited,as tolerated, full go)
incident_v$Length.of.Status <- difftime(incident_v$End.Date, incident_v$Start.of.Status,units=c("days"))
```
In womens' volleyball 28 lower body injuries occurred, 4 of them being ACL injuries, 1 of them being HSI injuries. 

```{r}
#LACROSSE incident dataset 
Incident_L <- Incident_L %>%                    #139 -> 86 obs.
filter(Incident.Type=="Injury") %>%
filter(Status %in% c("Out", "As Tolerated")) %>%
filter(Result.of.Sport.Participation=="Yes") %>%
select(-Result.of.Sport.Participation)

incident_L <- subset(Incident_L,select=c("anon_id","Date","Sport", "Position", "Date.of.Injury...Onset.of.symptoms", "Side", "Body.Part.", "Tissue.Type","OSICS14.Code","OSICS10.Diagnosis", "Final.Diagnosis", "Recurrence.of.Injury", "Injury.Prognosis", "General.mechanism","Specific.Mechanism", "Injured.While.", "Month", "Year","Incident.Type","Status", "Season.","Start.of.Status", "End.Date", "Total.Time.Injured"))  #34obs 

#Lower body injury binary
incident_L$LB.Injury <- ifelse(incident_L$Body.Part. %in% c("Thigh", "Ankle", "Lower leg", "Knee", "Foot", "Groin/hip"),1,0)
sum(incident_L$LB.Injury)

#ACL injury (most intense LB injury)
incident_L$ACL <- ifelse(incident_L$OSICS14.Code %in% c("KL1","KLA"),1,0)
sum(incident_L$ACL)
#HSI injury (overuse injury)
incident_L$HSI <- ifelse(incident_L$OSICS14.Code %in% c("TM1","TMB","TMS"),1,0)
sum(incident_L$HSI)

#4/12/23-4/18/25 (2 years)

#converting all dates
incident_l <- incident_L %>%
mutate(Total.Time.Injured = sum(Total.Time.Injured, na.rm = TRUE),
       Date = as.Date(Date, format = '%m/%d/%Y'),
       Start.of.Status=as.Date(Start.of.Status,format='%m/%d/%Y'),
       End.Date= as.Date(End.Date, format='%m/%d/%Y'),
       Date.of.Injury...Onset.of.symptoms= as.Date(Date.of.Injury...Onset.of.symptoms, format='%m/%d/%Y'),
       Sport=case_when(
    str_detect(Sport, "LACROSSE")~ "Lacrosse"
  )
)

#create a length of status variable (Out, limited,as tolerated, full go)
incident_l$Length.of.Status <- difftime(incident_l$End.Date, incident_l$Start.of.Status,units=c("days"))
```
In womens lacrosse 31 lower body injuries occurred, 3 being ACL related, 4 being HSI injury related.

2. VALD- Dynamo datasets
-we need to know the calculations for the asymmetry measures because they seem inconsistent.
```{r}
#load data
Dynamo_B <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - Dynamo WBB.csv")
Dynamo_S <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - Dynamo WSOC.csv")
Dynamo_V <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - Dynamo WVB.csv")
Dynamo_L <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - Dynamo WLAX.csv")
```

**1. Basketball**
```{r}
#selects variables of interest
dynamo_B <- subset(Dynamo_B, select = c('anon_id', 'Date', 'Knee.Ex.Right.Side.Max.Force..N.', 'Knee.Ex.Left.Side.Max.Force..N.', 'Knee.Ex.Max.Force..N..Asymmetry', 'Knee.Ex.Right.Side.Avg.Force..N.', 'Knee.Ex.Left.Side.Avg.Force..N.', 'Knee.Ex.Avg.Force.Asymmetry', 'Knee.Ex.Right.Side.Max.Impulse..Ns.', 'Knee.Ex.Left.Side.Max.Impulse..Ns.', 'Knee.Ex.Max.Impulse.Asymmetry', 'Knee.Ex.Right.Side.Avg.Impulse..Ns.', 'Knee.Ex.Left.Side.Avg.Impulse..Ns.', 'Knee.Ex.Avg.Impulse.Asymmetry', 'Knee.Ex.Right.Side.Max.Rate.of.Force.Development..Ns.', 'Knee.Ex.Left.Side.Max.Rate.of.Force.Development..Ns.', 'Knee.Ex.Max.Rate.of.Force.Development.Asymmetry', 'Knee.Ex.Right.Side.Avg.Rate.of.Force.Development..Ns.', 'Knee.Ex.Left.Side.Avg.Rate.of.Force.Development..Ns.', 'Knee.Ex.Avg.Rate.of.Force.Development.Asymmetry'))

#converts the date to a date object and omits the NAs
dynamo_B <- dynamo_B %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y'),
         Knee.Ex.Max.Force..N..Asymmetry = case_when(
           Knee.Ex.Left.Side.Max.Force..N. > Knee.Ex.Right.Side.Max.Force..N. ~ round(100 * (1 - (Knee.Ex.Right.Side.Max.Force..N. / Knee.Ex.Left.Side.Max.Force..N.)), 1),
           TRUE ~ Knee.Ex.Max.Force..N..Asymmetry
         )) %>%
  na.omit()               #ONLY 19 obs.
```
19 total observations, 3 with NA values in Knee.Ex.Max.Force..N..Asymmetry.

**2. Soccer**
```{r, warning = FALSE}
#selects variables of interest
dynamo_S <- subset(Dynamo_S, select = c('anon_id', 'Date', 'Knee.Ex.Right.Side.Max.Force..N.', 'Knee.Ex.Left.Side.Max.Force..N.', 'Knee.Ex.Max.Force..N..Asymmetry', 'Knee.Ex.Right.Side.Avg.Force..N.', 'Knee.Ex.Left.Side.Avg.Force..N.', 'Knee.Ex.Avg.Force.Asymmetry', 'Knee.Ex.Right.Side.Max.Impulse..Ns.', 'Knee.Ex.Left.Side.Max.Impulse..Ns.', 'Knee.Ex.Max.Impulse.Asymmetry', 'Knee.Ex.Right.Side.Avg.Impulse..Ns.', 'Knee.Ex.Left.Side.Avg.Impulse..Ns.', 'Knee.Ex.Avg.Impulse.Asymmetry', 'Knee.Ex.Right.Side.Max.Rate.of.Force.Development..Ns.', 'Knee.Ex.Left.Side.Max.Rate.of.Force.Development..Ns.', 'Knee.Ex.Max.Rate.of.Force.Development.Asymmetry', 'Knee.Ex.Right.Side.Avg.Rate.of.Force.Development..Ns.', 'Knee.Ex.Left.Side.Avg.Rate.of.Force.Development..Ns.', 'Knee.Ex.Avg.Rate.of.Force.Development.Asymmetry'))

#converts the date to a date object and puts values from different observations together into one observation
dynamo_S <- dynamo_S %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  group_by(anon_id, Date) %>%
  summarise(Knee.Ex.Right.Side.Max.Force..N. = sum(Knee.Ex.Right.Side.Max.Force..N., na.rm = TRUE), 
            Knee.Ex.Left.Side.Max.Force..N. = sum(Knee.Ex.Left.Side.Max.Force..N., na.rm = TRUE), 
            Knee.Ex.Max.Force..N..Asymmetry = sum(Knee.Ex.Max.Force..N..Asymmetry), 
            Knee.Ex.Right.Side.Avg.Force..N. = sum(Knee.Ex.Right.Side.Avg.Force..N., na.rm = TRUE), 
            Knee.Ex.Left.Side.Avg.Force..N. = sum(Knee.Ex.Left.Side.Avg.Force..N., na.rm = TRUE), 
            Knee.Ex.Avg.Force.Asymmetry = sum(Knee.Ex.Avg.Force.Asymmetry), 
            Knee.Ex.Right.Side.Max.Impulse..Ns. = sum(Knee.Ex.Right.Side.Max.Impulse..Ns., na.rm = TRUE), 
            Knee.Ex.Left.Side.Max.Impulse..Ns. = sum(Knee.Ex.Left.Side.Max.Impulse..Ns., na.rm = TRUE), 
            Knee.Ex.Max.Impulse.Asymmetry = sum(Knee.Ex.Max.Impulse.Asymmetry), 
            Knee.Ex.Right.Side.Avg.Impulse..Ns. = sum(Knee.Ex.Right.Side.Avg.Impulse..Ns., na.rm = TRUE), 
            Knee.Ex.Left.Side.Avg.Impulse..Ns. = sum(Knee.Ex.Left.Side.Avg.Impulse..Ns., na.rm = TRUE), 
            Knee.Ex.Avg.Impulse.Asymmetry = sum(Knee.Ex.Avg.Impulse.Asymmetry),
            Knee.Ex.Right.Side.Max.Rate.of.Force.Development..Ns. = sum(Knee.Ex.Right.Side.Max.Rate.of.Force.Development..Ns., na.rm = TRUE),
            Knee.Ex.Left.Side.Max.Rate.of.Force.Development..Ns. = sum(Knee.Ex.Left.Side.Max.Rate.of.Force.Development..Ns., na.rm = TRUE),
            Knee.Ex.Max.Rate.of.Force.Development.Asymmetry = sum(Knee.Ex.Max.Rate.of.Force.Development.Asymmetry),
            Knee.Ex.Right.Side.Avg.Rate.of.Force.Development..Ns. = sum(Knee.Ex.Right.Side.Avg.Rate.of.Force.Development..Ns., na.rm = TRUE),
            Knee.Ex.Left.Side.Avg.Rate.of.Force.Development..Ns. = sum(Knee.Ex.Left.Side.Avg.Rate.of.Force.Development..Ns., na.rm = TRUE),
            Knee.Ex.Avg.Rate.of.Force.Development.Asymmetry = sum(Knee.Ex.Avg.Rate.of.Force.Development.Asymmetry), .groups = "drop") %>%
  mutate(Knee.Ex.Max.Force..N..Asymmetry = round(100 * (1 - (Knee.Ex.Left.Side.Max.Force..N. / Knee.Ex.Right.Side.Max.Force..N.)), 1),
         Knee.Ex.Avg.Force.Asymmetry = round(100 * (1 - (Knee.Ex.Left.Side.Avg.Force..N. / Knee.Ex.Right.Side.Avg.Force..N.)), 1),
         Knee.Ex.Max.Impulse.Asymmetry = round(100 * (1 - (Knee.Ex.Left.Side.Max.Impulse..Ns. / Knee.Ex.Right.Side.Max.Impulse..Ns.)), 1),
         Knee.Ex.Avg.Impulse.Asymmetry = round(100 * (1 - (Knee.Ex.Left.Side.Avg.Impulse..Ns. / Knee.Ex.Right.Side.Avg.Impulse..Ns.)), 1),
         Knee.Ex.Max.Rate.of.Force.Development.Asymmetry = round(100 * (1 - (Knee.Ex.Left.Side.Max.Rate.of.Force.Development..Ns. / Knee.Ex.Right.Side.Max.Rate.of.Force.Development..Ns.)), 1),
         Knee.Ex.Avg.Rate.of.Force.Development.Asymmetry = round(100 * (1 - (Knee.Ex.Left.Side.Avg.Rate.of.Force.Development..Ns. / Knee.Ex.Right.Side.Avg.Rate.of.Force.Development..Ns.)), 1))
```
Only 1 observation, none of the asymmetry statistics are summarized. 

**3. Lacrosse**
```{r}
#selects variables of interest
dynamo_L <- subset(Dynamo_L, select = c('anon_id', 'Date', 'Knee.Ex.Right.Side.Max.Force..N.', 'Knee.Ex.Left.Side.Max.Force..N.', 'Knee.Ex.Max.Force..N..Asymmetry', 'Knee.Ex.Right.Side.Avg.Force..N.', 'Knee.Ex.Left.Side.Avg.Force..N.', 'Knee.Ex.Avg.Force.Asymmetry', 'Knee.Ex.Right.Side.Max.Impulse..Ns.', 'Knee.Ex.Left.Side.Max.Impulse..Ns.', 'Knee.Ex.Max.Impulse.Asymmetry', 'Knee.Ex.Right.Side.Avg.Impulse..Ns.', 'Knee.Ex.Left.Side.Avg.Impulse..Ns.', 'Knee.Ex.Avg.Impulse.Asymmetry', 'Knee.Ex.Right.Side.Max.Rate.of.Force.Development..Ns.', 'Knee.Ex.Left.Side.Max.Rate.of.Force.Development..Ns.', 'Knee.Ex.Max.Rate.of.Force.Development.Asymmetry', 'Knee.Ex.Right.Side.Avg.Rate.of.Force.Development..Ns.', 'Knee.Ex.Left.Side.Avg.Rate.of.Force.Development..Ns.', 'Knee.Ex.Avg.Rate.of.Force.Development.Asymmetry'))

#converts the date to a date object and omits the NAs
dynamo_L <- dynamo_L %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y'),
         Knee.Ex.Max.Force..N..Asymmetry = case_when(
           Knee.Ex.Left.Side.Max.Force..N. > Knee.Ex.Right.Side.Max.Force..N. ~ round(100 * (1 - (Knee.Ex.Right.Side.Max.Force..N. / Knee.Ex.Left.Side.Max.Force..N.)), 1),
           TRUE ~ Knee.Ex.Max.Force..N..Asymmetry
         )) %>%
  na.omit()
```
38 total observations, 23 with NA values in Knee.Ex.Max.Force..N..Asymmetry.

**4. Volleyball**
```{r}
#selects variables of interest
dynamo_V <- subset(Dynamo_V, select = c('anon_id', 'Date', 'Knee.Ex.Right.Side.Max.Force..N.', 'Knee.Ex.Left.Side.Max.Force..N.', 'Knee.Ex.Max.Force..N..Asymmetry', 'Knee.Ex.Right.Side.Avg.Force..N.', 'Knee.Ex.Left.Side.Avg.Force..N.', 'Knee.Ex.Avg.Force.Asymmetry', 'Knee.Ex.Right.Side.Max.Impulse..Ns.', 'Knee.Ex.Left.Side.Max.Impulse..Ns.', 'Knee.Ex.Max.Impulse.Asymmetry', 'Knee.Ex.Right.Side.Avg.Impulse..Ns.', 'Knee.Ex.Left.Side.Avg.Impulse..Ns.', 'Knee.Ex.Avg.Impulse.Asymmetry', 'Knee.Ex.Right.Side.Max.Rate.of.Force.Development..Ns.', 'Knee.Ex.Left.Side.Max.Rate.of.Force.Development..Ns.', 'Knee.Ex.Max.Rate.of.Force.Development.Asymmetry', 'Knee.Ex.Right.Side.Avg.Rate.of.Force.Development..Ns.', 'Knee.Ex.Left.Side.Avg.Rate.of.Force.Development..Ns.', 'Knee.Ex.Avg.Rate.of.Force.Development.Asymmetry'))

#converts the date to a date object and omits the NAs
dynamo_V <- dynamo_V %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y'),
         Knee.Ex.Max.Force..N..Asymmetry = case_when(
           Knee.Ex.Left.Side.Max.Force..N. > Knee.Ex.Right.Side.Max.Force..N. ~ round(100 * (1 - (Knee.Ex.Right.Side.Max.Force..N. / Knee.Ex.Left.Side.Max.Force..N.)), 1),
           TRUE ~ Knee.Ex.Max.Force..N..Asymmetry
         )) %>%
  na.omit()
```
Only has 4 observations from one player but not missing any data.


3. VALD- Forcedecks datasets
```{r}
#import datasets
Forcedecks_B <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - ForceDecks WBB.csv")
Forcedecks_S <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - ForceDecks WSOC.csv")
Forcedecks_L <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - ForceDecks WLAX.csv")
Forcedecks_V <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - ForceDecks WVB.csv")
```

#Forcedecks (VALD) basketball data
```{r}
#1: TEST TYPE=CMJ
CMJ_B <- subset(Forcedecks_B, select = c("anon_id","Date","Position","Test.Type","Weight..kg.","Countermovement.Depth..cm.","Peak.Power...BM..W.kg.","Landing.RFD..N.s.", "Eccentric.Concentric.Mean.Force.Ratio", "Peak.Landing.Force..Asym...N.", "Peak.Power..W.","Concentric.Maximum.RFD..N.s.","Concentric.Maximum.RFD..Right...N.s.","Concentric.Maximum.RFD..Left...N.s.","Eccentric.Mean.Braking.Force..N.", "Max.Jump.Height..cm.", "Max.Concentric.Peak.Force..N.", "Relative.Concentric.Power.Bilateral","Relative.Eccentric.Power.Bilateral", "Max.Peak.Power...BM", "Max.Eccentric.Peak.Force..N.","Max.RSI.Modified.VALD","Max.Concentric.RPD..N.s.","Max.Concentric.Peak.Velocity..m.s.", "Max.Eccentric.Peak.Velocity..m.s.", "Max.Peak.Landing.Force..N.", "MAX.Concentric.Peak.Power..W.", "Max.CMJ.Jump.Height..cm.","Max.CMJ.RSI.Modified..m.s.", "Max.CMJ.Concentric.RPD..N.s.", "Max.CMJ.Peak.Power..W.", "Max.CMJ.Peak.Landing.Force..N.","CMJ.Concentric.Relative.Peak.Power...Difference.from.First","CMJ.Eccentric.Relative.Peak.Power...Difference.from.First","Eccentric.Asymmetry","Concentric.Asymmetry"
))            #2751 obs & 36 vars.

#possible other final dataset 
cmj_b <- CMJ_B %>%
  na.omit()   #440 obs

#convert empty vectors to NA
CMJ_B[CMJ_B==""] <- NA    #colSums(is.na(forcedecks_B)) look at NAs in columns

#to use in summarise
#function for mode
get_mode <- function(v) {
  uniqv <- unique(v)
  uniqv[which.max(tabulate(match(v, uniqv)))]
}

#set all needed variables to numeric
CMJ_B$Countermovement.Depth..cm. <- as.numeric(CMJ_B$Countermovement.Depth..cm.)
CMJ_B$Peak.Power...BM..W.kg. <- as.numeric(CMJ_B$Peak.Power...BM..W.kg.)

#combining values from different observations into one
CMJ_b <- CMJ_B %>%
mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  group_by(anon_id, Date,Test.Type) %>%
  summarise(Weight..kg. = mean(Weight..kg., na.rm = TRUE),
            Countermovement.Depth..cm.= mean(Countermovement.Depth..cm., na.rm=TRUE),
            Peak.Power...BM..W.kg.= mean(Peak.Power...BM..W.kg., na.rm=TRUE),
            Landing.RFD..N.s.= mean(Landing.RFD..N.s.,na.rm=TRUE),
            Eccentric.Concentric.Mean.Force.Ratio= mean(Eccentric.Concentric.Mean.Force.Ratio,na.rm=TRUE),
            Peak.Landing.Force..Asym...N.= mean(Peak.Landing.Force..Asym...N.,na.rm=TRUE),
            Peak.Power..W.= mean(Peak.Power..W.,na.rm=TRUE),
            Concentric.Maximum.RFD..N.s.= mean(Concentric.Maximum.RFD..N.s.,na.rm=TRUE),
            Concentric.Maximum.RFD..Right...N.s.= mean(Concentric.Maximum.RFD..Right...N.s.,na.rm=TRUE),
            Concentric.Maximum.RFD..Left...N.s.= mean(Concentric.Maximum.RFD..Left...N.s.,na.rm=TRUE),
            Eccentric.Mean.Braking.Force..N.= mean(Eccentric.Mean.Braking.Force..N.,na.rm=TRUE),
            Max.Jump.Height..cm.= mean(Max.Jump.Height..cm.,na.rm=TRUE),
            Max.Concentric.Peak.Force..N.= mean(Max.Concentric.Peak.Force..N.,na.rm=TRUE),
            Relative.Concentric.Power.Bilateral= mean(Relative.Concentric.Power.Bilateral,na.rm=TRUE),
            Relative.Eccentric.Power.Bilateral= mean(Relative.Eccentric.Power.Bilateral,na.rm=TRUE),
            Max.Peak.Power...BM= mean(Max.Peak.Power...BM,na.rm=TRUE),
            Max.Eccentric.Peak.Force..N.= mean(Max.Eccentric.Peak.Force..N.,na.rm=TRUE),
            Max.RSI.Modified.VALD= mean(Max.RSI.Modified.VALD,na.rm=TRUE),
            Max.Concentric.RPD..N.s.= mean(Max.Concentric.RPD..N.s.,na.rm=TRUE),
            Max.Concentric.Peak.Velocity..m.s.= mean(Max.Concentric.Peak.Velocity..m.s.,na.rm=TRUE),
            Max.Eccentric.Peak.Velocity..m.s.= mean(Max.Eccentric.Peak.Velocity..m.s.,na.rm=TRUE),
            Max.Peak.Landing.Force..N.= mean(Max.Peak.Landing.Force..N.,na.rm=TRUE),
            MAX.Concentric.Peak.Power..W.= mean(MAX.Concentric.Peak.Power..W.,na.rm=TRUE),
            Max.CMJ.Jump.Height..cm.= mean(Max.CMJ.Jump.Height..cm.,na.rm=TRUE),
            Max.CMJ.RSI.Modified..m.s.= mean(Max.CMJ.RSI.Modified..m.s.,na.rm=TRUE),
            Max.CMJ.Concentric.RPD..N.s.= mean(Max.CMJ.Concentric.RPD..N.s.,na.rm=TRUE),
            Max.CMJ.Peak.Power..W.= mean(Max.CMJ.Peak.Power..W.,na.rm=TRUE),
            Max.CMJ.Peak.Landing.Force..N.= mean(Max.CMJ.Peak.Landing.Force..N.,na.rm=TRUE),
            CMJ.Concentric.Relative.Peak.Power...Difference.from.First= mean(CMJ.Concentric.Relative.Peak.Power...Difference.from.First,na.rm=TRUE),
            CMJ.Eccentric.Relative.Peak.Power...Difference.from.First= mean(CMJ.Eccentric.Relative.Peak.Power...Difference.from.First,na.rm=TRUE),
            Position= get_mode(Position),
            Eccentric.Asymmetry= get_mode(Eccentric.Asymmetry),
            Concentric.Asymmetry= get_mode(Concentric.Asymmetry),
            .groups = 'drop'
              )                   #1393 obs & 36 vars
#fix NaN values

CMJ_bb <- CMJ_b %>%
  na.omit()   #196 obs & 36 vars
```

```{r}
#2 TEST TYPE=HJ
HJ_B <- Forcedecks_B %>%
  filter(Test.Type=="HJ")  %>% #424 obs
  select("anon_id", "Date", "Corrected.Standing.Weight..Kg.", "Mean.RSI..Flight.Contact.Time.", "Active.Stiffness..N.m.", "Best.Average.Force..N.", "Best.Average.Force..Asym...N.", "Best.Time.to.Peak.Force..ms.", "Best.Contact.Time..ms.", "Best.Flight.Time..ms.", "Best.Impulse..N.s.", "Best.Peak.Force..N.", "Best.Peak.Force..Asym...N.", "Mean.Average.Force..N.", "Mean.Average.Force..Asym...N.", "Mean.Landing.RFD..N.s.", "Mean.Landing.RFD..Asym...N.s.", "Stiffness.Fatigue....", "Stiffness.Fatigue..Asym.....", "Max.Jump.Height..cm.") %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()
                 #409 obs & 20 vars
```

```{r}
#3: TEST TYPE= IMTP
IMTP_B <- Forcedecks_B %>%
  filter(Test.Type=="IMTP") %>% #162 
  select("anon_id", "Date", "Baseline.Force..N.","Baseline.Force..Asym...N.", "Peak.Vertical.Force..N.", "Peak.Vertical.Force...BM..N.kg.", "Peak.Vertical.Force..Asym...N.", "RFD...50ms..N.s.", "RFD...50ms..Asym...N.s.", "RFD...100ms..N.s.", "RFD...100ms..Asym...N.s.", "RFD...150ms..N.s.", "RFD...150ms..Asym...N.s.", "RFD...200ms..N.s.", "RFD...200ms..Asym...N.s.", "Net.Peak.Vertical.Force..N.s.", "Net.Peak.Vertical.Force..Asym...N.s.", "Force.at.200ms...BM..N.kg.", "Eccentric.Asymmetry", "Concentric.Asymmetry","MEAN.Eccentric.Mean.Force.Left", "MEAN.Eccentric.Mean.Force.Right", "MEAN.Concentric.Mean.Force.Left", "MEAN.Concentric.Mean.Force.Right", "MEAN.Concentric.Mean.Force.Asym", "MEAN.Peak.Landing.Force.Asym",  "MEAN.Relative.Peak.Power", "MEAN.CMJ.Concentric.Force", "MEAN.Peak.Landing.Force.Left", "MEAN.Peak.Landing.Force.Right", "DSI", "DSI.Bucket") %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()   #50 obs & 30 vars
```

#Forcedecks (VALD) Soccer Data
```{r}
#1: TEST TYPE==CMJ
#selects variables of interest
CMJ_S <- subset(Forcedecks_S, select = c("anon_id","Date","Position","Test.Type","Weight..kg.","Countermovement.Depth..cm.","Peak.Power...BM..W.kg.","Landing.RFD..N.s.", "Eccentric.Concentric.Mean.Force.Ratio", "Peak.Landing.Force..Asym...N.", "Peak.Power..W.","Concentric.Maximum.RFD..N.s.","Concentric.Maximum.RFD..Right...N.s.","Concentric.Maximum.RFD..Left...N.s.","Eccentric.Mean.Braking.Force..N.", "Max.Jump.Height..cm.", "Max.Concentric.Peak.Force..N.", "Relative.Concentric.Power.Bilateral",
"Relative.Eccentric.Power.Bilateral","Max.Peak.Power...BM", "Max.Eccentric.Peak.Force..N.",
"Max.RSI.Modified.VALD","Max.Concentric.RPD..N.s.", "Max.Concentric.Peak.Velocity..m.s.", "Max.Eccentric.Peak.Velocity..m.s.", "Max.Peak.Landing.Force..N.", "MAX.Concentric.Peak.Power..W.","Max.CMJ.Jump.Height..cm.",
"Max.CMJ.RSI.Modified..m.s.","Max.CMJ.Concentric.RPD..N.s.","Max.CMJ.Peak.Power..W.","Max.CMJ.Peak.Landing.Force..N.","CMJ.Concentric.Relative.Peak.Power...Difference.from.First","CMJ.Eccentric.Relative.Peak.Power...Difference.from.First","Eccentric.Asymmetry","Concentric.Asymmetry"
))        #3443 obs & 36 vars 

#OTHER POSSIBLE FINAL DATASET
cmj_s <- CMJ_S %>%
na.omit()  #562 obs & 36 vars
cmj_s[cmj_s==""] <- NA

CMJ_S[CMJ_S==""] <- NA

#combining values from different observations into one
CMJ_s <- CMJ_S %>%
mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  group_by(anon_id, Date, Test.Type) %>%
  summarise(Weight..kg. = mean(Weight..kg., na.rm = TRUE),
            Countermovement.Depth..cm.= mean(Countermovement.Depth..cm., na.rm=TRUE),
            Peak.Power...BM..W.kg.= mean(Peak.Power...BM..W.kg., na.rm=TRUE),
            Landing.RFD..N.s.= mean(Landing.RFD..N.s.,na.rm=TRUE),
            Eccentric.Concentric.Mean.Force.Ratio= mean(Eccentric.Concentric.Mean.Force.Ratio,na.rm=TRUE),
            Peak.Landing.Force..Asym...N.= mean(Peak.Landing.Force..Asym...N.,na.rm=TRUE),
            Peak.Power..W.= mean(Peak.Power..W.,na.rm=TRUE),
            Concentric.Maximum.RFD..N.s.= mean(Concentric.Maximum.RFD..N.s.,na.rm=TRUE),
            Concentric.Maximum.RFD..Right...N.s.= mean(Concentric.Maximum.RFD..Right...N.s.,na.rm=TRUE),
            Concentric.Maximum.RFD..Left...N.s.= mean(Concentric.Maximum.RFD..Left...N.s.,na.rm=TRUE),
            Eccentric.Mean.Braking.Force..N.= mean(Eccentric.Mean.Braking.Force..N.,na.rm=TRUE),
            Max.Jump.Height..cm.= mean(Max.Jump.Height..cm.,na.rm=TRUE),
            Max.Concentric.Peak.Force..N.= mean(Max.Concentric.Peak.Force..N.,na.rm=TRUE),
            Relative.Concentric.Power.Bilateral= mean(Relative.Concentric.Power.Bilateral,na.rm=TRUE),
            Relative.Eccentric.Power.Bilateral= mean(Relative.Eccentric.Power.Bilateral,na.rm=TRUE),
            Max.Peak.Power...BM= mean(Max.Peak.Power...BM,na.rm=TRUE),
            Max.Eccentric.Peak.Force..N.= mean(Max.Eccentric.Peak.Force..N.,na.rm=TRUE),
            Max.RSI.Modified.VALD= mean(Max.RSI.Modified.VALD,na.rm=TRUE),
            Max.Concentric.RPD..N.s.= mean(Max.Concentric.RPD..N.s.,na.rm=TRUE),
            Max.Concentric.Peak.Velocity..m.s.= mean(Max.Concentric.Peak.Velocity..m.s.,na.rm=TRUE),
            Max.Eccentric.Peak.Velocity..m.s.= mean(Max.Eccentric.Peak.Velocity..m.s.,na.rm=TRUE),
            Max.Peak.Landing.Force..N.= mean(Max.Peak.Landing.Force..N.,na.rm=TRUE),
            MAX.Concentric.Peak.Power..W.= mean(MAX.Concentric.Peak.Power..W.,na.rm=TRUE),
            Max.CMJ.Jump.Height..cm.= mean(Max.CMJ.Jump.Height..cm.,na.rm=TRUE),
            Max.CMJ.RSI.Modified..m.s.= mean(Max.CMJ.RSI.Modified..m.s.,na.rm=TRUE),
            Max.CMJ.Concentric.RPD..N.s.= mean(Max.CMJ.Concentric.RPD..N.s.,na.rm=TRUE),
            Max.CMJ.Peak.Power..W.= mean(Max.CMJ.Peak.Power..W.,na.rm=TRUE),
            Max.CMJ.Peak.Landing.Force..N.= mean(Max.CMJ.Peak.Landing.Force..N.,na.rm=TRUE),
            CMJ.Concentric.Relative.Peak.Power...Difference.from.First= mean(CMJ.Concentric.Relative.Peak.Power...Difference.from.First,na.rm=TRUE),
            CMJ.Eccentric.Relative.Peak.Power...Difference.from.First= mean(CMJ.Eccentric.Relative.Peak.Power...Difference.from.First,na.rm=TRUE),
            Position= get_mode(Position),
            Eccentric.Asymmetry= get_mode(Eccentric.Asymmetry),
            Concentric.Asymmetry= get_mode(Concentric.Asymmetry),
            .groups = 'drop'
              )               # 1077 obs & 32 vars -> 1571

CMJ_soc <- CMJ_s %>%
  na.omit()   #621 obs & 32 vars -> 600 -> 257 obs & 36 vars 
```

```{r}
#2 TEST TYPE= HJ
HJ_S <- Forcedecks_S %>%
  filter(Test.Type=="HJ")  %>%  #575 obs
  select("anon_id", "Date", "Corrected.Standing.Weight..Kg.", "Mean.RSI..Flight.Contact.Time.", "Active.Stiffness..N.m.", "Best.Average.Force..N.", "Best.Average.Force..Asym...N.", "Best.Time.to.Peak.Force..ms.", "Best.Contact.Time..ms.", "Best.Flight.Time..ms.", "Best.Impulse..N.s.", "Best.Peak.Force..N.", "Best.Peak.Force..Asym...N.", "Mean.Average.Force..N.", "Mean.Average.Force..Asym...N.", "Mean.Landing.RFD..N.s.", "Mean.Landing.RFD..Asym...N.s.", "Stiffness.Fatigue....", "Stiffness.Fatigue..Asym.....", "Max.Jump.Height..cm.") %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()
                 #556 obs & 20 vars
```

```{r}
#3 TEST TYPE- SLJ
SLJ_S <- Forcedecks_S %>%
  filter(Test.Type=="SLJ")  # 455 obs

#important variables 
SLJ_S <- subset(SLJ_S, select = c("anon_id", "Date", "Position", "Weight..kg.", "Jump.Height..Flight.Time...cm.",  "Jump.Height..Imp.Mom...cm.", "Max.Jump.Height..cm.", "Max.Single.Leg.Jump.Height.Left", "Max.Single.Leg.Jump.Height.Right", "First.SLJ.Jump.Height", "Max.Concentric.Peak.Velocity..m.s.", "Max.Eccentric.Peak.Velocity..m.s.", "RSI.Modified..m.s.", "Max.RSI.Modified..m.s.", "Max.RSI.Modified.VALD", "Eccentric.Mean.Braking.Force..N.", "Landing.RFD..N.s.","Concentric.Maximum.RFD..N.s.", "Concentric.Maximum.RFD..Right...N.s.","Concentric.Maximum.RFD..Left...N.s.", "Concentric.Impulse..Ns.", "Concentric.Impulse..Left...Ns.", "Concentric.Impulse..Right...Ns.", "Max.Concentric.Peak.Force..N.", "Max.Eccentric.Peak.Force..N."
))                        #455 obs & 25 vars

SLJ_S[SLJ_S==""] <- NA

#combining values from different observations into one
SLJ_s <- SLJ_S %>%
mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  group_by(anon_id, Date) %>%
  summarise(Weight..kg. = mean(Weight..kg., na.rm = TRUE),
            Jump.Height..Flight.Time...cm.= mean(Jump.Height..Flight.Time...cm., na.rm=TRUE),
            Jump.Height..Imp.Mom...cm.= mean(Jump.Height..Imp.Mom...cm.,na.rm=TRUE),
            Max.Jump.Height..cm.= mean(Max.Jump.Height..cm. ,na.rm=TRUE),
            Max.Single.Leg.Jump.Height.Left= mean(Max.Single.Leg.Jump.Height.Left ,na.rm=TRUE),
            Max.Single.Leg.Jump.Height.Right= mean(Max.Single.Leg.Jump.Height.Right ,na.rm=TRUE),
            First.SLJ.Jump.Height= mean(First.SLJ.Jump.Height, na.rm=TRUE),
            Max.Concentric.Peak.Velocity..m.s.= mean(Max.Concentric.Peak.Velocity..m.s., na.rm=TRUE),
            Max.Eccentric.Peak.Velocity..m.s.= mean(Max.Eccentric.Peak.Velocity..m.s., na.rm=TRUE),
            RSI.Modified..m.s.= mean(RSI.Modified..m.s., na.rm=TRUE),
            Max.RSI.Modified..m.s.= mean(Max.RSI.Modified..m.s., na.rm=TRUE),
            Max.RSI.Modified.VALD= mean(Max.RSI.Modified.VALD, na.rm=TRUE),
            Eccentric.Mean.Braking.Force..N.= mean(Eccentric.Mean.Braking.Force..N., na.rm=TRUE),
            Landing.RFD..N.s.= mean(Landing.RFD..N.s., na.rm=TRUE),
            Concentric.Maximum.RFD..N.s.= mean(Concentric.Maximum.RFD..N.s., na.rm=TRUE),
            Concentric.Maximum.RFD..Right...N.s.= mean(Concentric.Maximum.RFD..Right...N.s.,na.rm=TRUE),
            Concentric.Maximum.RFD..Left...N.s.= mean(Concentric.Maximum.RFD..Left...N.s.,na.rm=TRUE),
            Concentric.Impulse..Ns.= mean(Concentric.Impulse..Ns.,na.rm=TRUE),
            Concentric.Impulse..Left...Ns.= mean(Concentric.Impulse..Left...Ns.,na.rm=TRUE),
            Concentric.Impulse..Right...Ns.= mean(Concentric.Impulse..Right...Ns.,na.rm=TRUE),
            Max.Concentric.Peak.Force..N.= mean(Max.Concentric.Peak.Force..N.,na.rm=TRUE),
            Max.Eccentric.Peak.Force..N.= mean(Max.Eccentric.Peak.Force..N.,na.rm=TRUE),
            Position= get_mode(Position),
            .groups = 'drop'
              )   #83 obs 25 vars
```

```{r}
#4 TEST TYPE- IMTP
IMTP_S <- Forcedecks_S %>%
  filter(Test.Type=="IMTP") %>%   #200 obs 
  select("anon_id", "Date", "Baseline.Force..N.","Baseline.Force..Asym...N.", "Peak.Vertical.Force..N.", "Peak.Vertical.Force...BM..N.kg.", "Peak.Vertical.Force..Asym...N.", "RFD...50ms..N.s.", "RFD...50ms..Asym...N.s.", "RFD...100ms..N.s.", "RFD...100ms..Asym...N.s.", "RFD...150ms..N.s.", "RFD...150ms..Asym...N.s.", "RFD...200ms..N.s.", "RFD...200ms..Asym...N.s.", "Net.Peak.Vertical.Force..N.s.", "Net.Peak.Vertical.Force..Asym...N.s.", "Force.at.200ms...BM..N.kg.", "Eccentric.Asymmetry", "Concentric.Asymmetry","MEAN.Eccentric.Mean.Force.Left", "MEAN.Eccentric.Mean.Force.Right", "MEAN.Concentric.Mean.Force.Left", "MEAN.Concentric.Mean.Force.Right", "MEAN.Concentric.Mean.Force.Asym", "MEAN.Peak.Landing.Force.Asym",  "MEAN.Relative.Peak.Power", "MEAN.CMJ.Concentric.Force", "MEAN.Peak.Landing.Force.Left", "MEAN.Peak.Landing.Force.Right", "DSI", "DSI.Bucket") %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()   #68 obs & 32 vars
```

#Forcedecks (VALD) Lacrosse Data
```{r}
#1 : TEST TYPE= CMJ
#selects variables of interest
CMJ_L <- subset(Forcedecks_L, select = c("anon_id","Date","Position","Test.Type","Weight..kg.","Countermovement.Depth..cm.","Peak.Power...BM..W.kg.","Landing.RFD..N.s.", "Eccentric.Concentric.Mean.Force.Ratio", "Peak.Landing.Force..Asym...N.", "Peak.Power..W.","Concentric.Maximum.RFD..N.s.","Concentric.Maximum.RFD..Right...N.s.","Concentric.Maximum.RFD..Left...N.s.","Eccentric.Mean.Braking.Force..N.", "Max.Jump.Height..cm.", "Max.Concentric.Peak.Force..N.", "Relative.Concentric.Power.Bilateral",
"Relative.Eccentric.Power.Bilateral","Max.Peak.Power...BM", "Max.Eccentric.Peak.Force..N.",
"Max.RSI.Modified.VALD","Max.Concentric.RPD..N.s.", "Max.Concentric.Peak.Velocity..m.s.", "Max.Eccentric.Peak.Velocity..m.s.", "Max.Peak.Landing.Force..N.", "MAX.Concentric.Peak.Power..W.","Max.CMJ.Jump.Height..cm.",
"Max.CMJ.RSI.Modified..m.s.","Max.CMJ.Concentric.RPD..N.s.","Max.CMJ.Peak.Power..W.","Max.CMJ.Peak.Landing.Force..N.","CMJ.Concentric.Relative.Peak.Power...Difference.from.First","CMJ.Eccentric.Relative.Peak.Power...Difference.from.First","Eccentric.Asymmetry","Concentric.Asymmetry"
))        #1939 obs & 36 vars 

#possible other final dataset
cmj_l <- CMJ_L %>%
  na.omit()      #377 obs 

CMJ_L[CMJ_L==""] <- NA

#combining values from different observations into one
CMJ_l <- CMJ_L %>%
mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  group_by(anon_id, Date, Test.Type) %>%
  summarise(Weight..kg. = mean(Weight..kg., na.rm = TRUE),
            Countermovement.Depth..cm.= mean(Countermovement.Depth..cm., na.rm=TRUE),
            Peak.Power...BM..W.kg.= mean(Peak.Power...BM..W.kg., na.rm=TRUE),
            Landing.RFD..N.s.= mean(Landing.RFD..N.s.,na.rm=TRUE),
            Eccentric.Concentric.Mean.Force.Ratio= mean(Eccentric.Concentric.Mean.Force.Ratio,na.rm=TRUE),
            Peak.Landing.Force..Asym...N.= mean(Peak.Landing.Force..Asym...N.,na.rm=TRUE),
            Peak.Power..W.= mean(Peak.Power..W.,na.rm=TRUE),
            Concentric.Maximum.RFD..N.s.= mean(Concentric.Maximum.RFD..N.s.,na.rm=TRUE),
            Concentric.Maximum.RFD..Right...N.s.= mean(Concentric.Maximum.RFD..Right...N.s.,na.rm=TRUE),
            Concentric.Maximum.RFD..Left...N.s.= mean(Concentric.Maximum.RFD..Left...N.s.,na.rm=TRUE),
            Eccentric.Mean.Braking.Force..N.= mean(Eccentric.Mean.Braking.Force..N.,na.rm=TRUE),
            Max.Jump.Height..cm.= mean(Max.Jump.Height..cm.,na.rm=TRUE),
            Max.Concentric.Peak.Force..N.= mean(Max.Concentric.Peak.Force..N.,na.rm=TRUE),
            Relative.Concentric.Power.Bilateral= mean(Relative.Concentric.Power.Bilateral,na.rm=TRUE),
            Relative.Eccentric.Power.Bilateral= mean(Relative.Eccentric.Power.Bilateral,na.rm=TRUE),
            Max.Peak.Power...BM= mean(Max.Peak.Power...BM,na.rm=TRUE),
            Max.Eccentric.Peak.Force..N.= mean(Max.Eccentric.Peak.Force..N.,na.rm=TRUE),
            Max.RSI.Modified.VALD= mean(Max.RSI.Modified.VALD,na.rm=TRUE),
            Max.Concentric.RPD..N.s.= mean(Max.Concentric.RPD..N.s.,na.rm=TRUE),
            Max.Concentric.Peak.Velocity..m.s.= mean(Max.Concentric.Peak.Velocity..m.s.,na.rm=TRUE),
            Max.Eccentric.Peak.Velocity..m.s.= mean(Max.Eccentric.Peak.Velocity..m.s.,na.rm=TRUE),
            Max.Peak.Landing.Force..N.= mean(Max.Peak.Landing.Force..N.,na.rm=TRUE),
            MAX.Concentric.Peak.Power..W.= mean(MAX.Concentric.Peak.Power..W.,na.rm=TRUE),
            Max.CMJ.Jump.Height..cm.= mean(Max.CMJ.Jump.Height..cm.,na.rm=TRUE),
            Max.CMJ.RSI.Modified..m.s.= mean(Max.CMJ.RSI.Modified..m.s.,na.rm=TRUE),
            Max.CMJ.Concentric.RPD..N.s.= mean(Max.CMJ.Concentric.RPD..N.s.,na.rm=TRUE),
            Max.CMJ.Peak.Power..W.= mean(Max.CMJ.Peak.Power..W.,na.rm=TRUE),
            Max.CMJ.Peak.Landing.Force..N.= mean(Max.CMJ.Peak.Landing.Force..N.,na.rm=TRUE),
            CMJ.Concentric.Relative.Peak.Power...Difference.from.First= mean(CMJ.Concentric.Relative.Peak.Power...Difference.from.First,na.rm=TRUE),
            CMJ.Eccentric.Relative.Peak.Power...Difference.from.First= mean(CMJ.Eccentric.Relative.Peak.Power...Difference.from.First,na.rm=TRUE),
            Position= get_mode(Position),
            Eccentric.Asymmetry= get_mode(Eccentric.Asymmetry),
            Concentric.Asymmetry= get_mode(Concentric.Asymmetry),
            .groups = 'drop'
              )               # 1238 obs & 36 vars

CMJ_lax <- CMJ_l %>%
  na.omit()   #277 obs & 36 vars
```

```{r}
#2: TEST TYPE= HJ
HJ_L <- Forcedecks_L %>%
  filter(Test.Type=="HJ")  %>%  #582 obs
  select("anon_id", "Date", "Corrected.Standing.Weight..Kg.", "Mean.RSI..Flight.Contact.Time.", "Active.Stiffness..N.m.", "Best.Average.Force..N.", "Best.Average.Force..Asym...N.", "Best.Time.to.Peak.Force..ms.", "Best.Contact.Time..ms.", "Best.Flight.Time..ms.", "Best.Impulse..N.s.", "Best.Peak.Force..N.", "Best.Peak.Force..Asym...N.", "Mean.Average.Force..N.", "Mean.Average.Force..Asym...N.", "Mean.Landing.RFD..N.s.", "Mean.Landing.RFD..Asym...N.s.", "Stiffness.Fatigue....", "Stiffness.Fatigue..Asym.....", "Max.Jump.Height..cm.") %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()
                 #573 obs & 20 vars
```

```{r}
#3: TEST TYPE: SLJ
SLJ_L <- Forcedecks_L %>%
  filter(Test.Type=="SLJ")  #190 obs

#important variables 
SLJ_L <- subset(SLJ_L, select = c("anon_id", "Date", "Position", "Weight..kg.", "Jump.Height..Flight.Time...cm.",  "Jump.Height..Imp.Mom...cm.", "Max.Jump.Height..cm.", "Max.Single.Leg.Jump.Height.Left", "Max.Single.Leg.Jump.Height.Right", "First.SLJ.Jump.Height", "Max.Concentric.Peak.Velocity..m.s.", "Max.Eccentric.Peak.Velocity..m.s.", "RSI.Modified..m.s.", "Max.RSI.Modified..m.s.", "Max.RSI.Modified.VALD", "Eccentric.Mean.Braking.Force..N.", "Landing.RFD..N.s.","Concentric.Maximum.RFD..N.s.", "Concentric.Maximum.RFD..Right...N.s.","Concentric.Maximum.RFD..Left...N.s.", "Concentric.Impulse..Ns.", "Concentric.Impulse..Left...Ns.", "Concentric.Impulse..Right...Ns.", "Max.Concentric.Peak.Force..N.", "Max.Eccentric.Peak.Force..N."
))                        #190 obs & 25 vars

SLJ_L[SLJ_L==""] <- NA

#combining values from different observations into one
SLJ_l <- SLJ_L %>%
mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  group_by(anon_id, Date) %>%
  summarise(Weight..kg. = mean(Weight..kg., na.rm = TRUE),
            Jump.Height..Flight.Time...cm.= mean(Jump.Height..Flight.Time...cm., na.rm=TRUE),
            Jump.Height..Imp.Mom...cm.= mean(Jump.Height..Imp.Mom...cm.,na.rm=TRUE),
            Max.Jump.Height..cm.= mean(Max.Jump.Height..cm. ,na.rm=TRUE),
            Max.Single.Leg.Jump.Height.Left= mean(Max.Single.Leg.Jump.Height.Left ,na.rm=TRUE),
            Max.Single.Leg.Jump.Height.Right= mean(Max.Single.Leg.Jump.Height.Right ,na.rm=TRUE),
            First.SLJ.Jump.Height= mean(First.SLJ.Jump.Height, na.rm=TRUE),
            Max.Concentric.Peak.Velocity..m.s.= mean(Max.Concentric.Peak.Velocity..m.s., na.rm=TRUE),
            Max.Eccentric.Peak.Velocity..m.s.= mean(Max.Eccentric.Peak.Velocity..m.s., na.rm=TRUE),
            RSI.Modified..m.s.= mean(RSI.Modified..m.s., na.rm=TRUE),
            Max.RSI.Modified..m.s.= mean(Max.RSI.Modified..m.s., na.rm=TRUE),
            Max.RSI.Modified.VALD= mean(Max.RSI.Modified.VALD, na.rm=TRUE),
            Eccentric.Mean.Braking.Force..N.= mean(Eccentric.Mean.Braking.Force..N., na.rm=TRUE),
            Landing.RFD..N.s.= mean(Landing.RFD..N.s., na.rm=TRUE),
            Concentric.Maximum.RFD..N.s.= mean(Concentric.Maximum.RFD..N.s., na.rm=TRUE),
            Concentric.Maximum.RFD..Right...N.s.= mean(Concentric.Maximum.RFD..Right...N.s.,na.rm=TRUE),
            Concentric.Maximum.RFD..Left...N.s.= mean(Concentric.Maximum.RFD..Left...N.s.,na.rm=TRUE),
            Concentric.Impulse..Ns.= mean(Concentric.Impulse..Ns.,na.rm=TRUE),
            Concentric.Impulse..Left...Ns.= mean(Concentric.Impulse..Left...Ns.,na.rm=TRUE),
            Concentric.Impulse..Right...Ns.= mean(Concentric.Impulse..Right...Ns.,na.rm=TRUE),
            Max.Concentric.Peak.Force..N.= mean(Max.Concentric.Peak.Force..N.,na.rm=TRUE),
            Max.Eccentric.Peak.Force..N.= mean(Max.Eccentric.Peak.Force..N.,na.rm=TRUE),
            Position= get_mode(Position),
            .groups = 'drop'
              )   #60 obs 25 vars
```

```{r}
#4 TEST TYPE- IMTP
#DSI
#ballistic, explosive, concurrent 
IMTP_L <- Forcedecks_L %>%
  filter(Test.Type=="IMTP") %>%   #100 obs 
  select("anon_id", "Date", "Baseline.Force..N.","Baseline.Force..Asym...N.", "Peak.Vertical.Force..N.", "Peak.Vertical.Force...BM..N.kg.", "Peak.Vertical.Force..Asym...N.", "RFD...50ms..N.s.", "RFD...50ms..Asym...N.s.", "RFD...100ms..N.s.", "RFD...100ms..Asym...N.s.", "RFD...150ms..N.s.", "RFD...150ms..Asym...N.s.", "RFD...200ms..N.s.", "RFD...200ms..Asym...N.s.", "Net.Peak.Vertical.Force..N.s.", "Net.Peak.Vertical.Force..Asym...N.s.", "Force.at.200ms...BM..N.kg.", "Eccentric.Asymmetry", "Concentric.Asymmetry","MEAN.Eccentric.Mean.Force.Left", "MEAN.Eccentric.Mean.Force.Right", "MEAN.Concentric.Mean.Force.Left", "MEAN.Concentric.Mean.Force.Right", "MEAN.Concentric.Mean.Force.Asym", "MEAN.Peak.Landing.Force.Asym",  "MEAN.Relative.Peak.Power", "MEAN.CMJ.Concentric.Force", "MEAN.Peak.Landing.Force.Left", "MEAN.Peak.Landing.Force.Right", "DSI", "DSI.Bucket") %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()   #33 obs & 32 vars
```

#Forcedecks (VALD) Volleyball Data
```{r}
#1: TEST TYPE=CMJ
CMJ_V <- Forcedecks_V %>%
  filter(Test.Type=="CMJ")

CMJ_V <- subset(CMJ_V, select = c("anon_id","Date","Position","Test.Type","Weight..kg.","Countermovement.Depth..cm.","Peak.Power...BM..W.kg.","Landing.RFD..N.s.", "Eccentric.Concentric.Mean.Force.Ratio", "Peak.Landing.Force..Asym...N.", "Peak.Power..W.","Concentric.Maximum.RFD..N.s.","Concentric.Maximum.RFD..Right...N.s.","Concentric.Maximum.RFD..Left...N.s.","Eccentric.Mean.Braking.Force..N.", "Max.Jump.Height..cm.", "Max.Concentric.Peak.Force..N.", "Relative.Concentric.Power.Bilateral",
"Relative.Eccentric.Power.Bilateral","Max.Peak.Power...BM", "Max.Eccentric.Peak.Force..N.",
"Max.RSI.Modified.VALD","Max.Concentric.RPD..N.s.", "Max.Concentric.Peak.Velocity..m.s.", "Max.Eccentric.Peak.Velocity..m.s.", "Max.Peak.Landing.Force..N.", "MAX.Concentric.Peak.Power..W.","Max.CMJ.Jump.Height..cm.",
"Max.CMJ.RSI.Modified..m.s.","Max.CMJ.Concentric.RPD..N.s.","Max.CMJ.Peak.Power..W.","Max.CMJ.Peak.Landing.Force..N.","CMJ.Concentric.Relative.Peak.Power...Difference.from.First","CMJ.Eccentric.Relative.Peak.Power...Difference.from.First","Eccentric.Asymmetry","Concentric.Asymmetry"
))        #5332 obs & 36 vars 

#possible different final dataset 
cmj_v <- CMJ_V %>%
  na.omit()  #457 obs

CMJ_V[CMJ_V==""] <- NA

#combining values from different observations into one
CMJ_v <- CMJ_V %>%
mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  filter(Test.Type=="CMJ") %>%   #add to others even tho might not need
  group_by(anon_id, Date) %>%
  summarise(Weight..kg. = mean(Weight..kg., na.rm = TRUE),
            Countermovement.Depth..cm.= mean(Countermovement.Depth..cm., na.rm=TRUE),
            Peak.Power...BM..W.kg.= mean(Peak.Power...BM..W.kg., na.rm=TRUE),
            Landing.RFD..N.s.= mean(Landing.RFD..N.s.,na.rm=TRUE),
            Eccentric.Concentric.Mean.Force.Ratio= mean(Eccentric.Concentric.Mean.Force.Ratio,na.rm=TRUE),
            Peak.Landing.Force..Asym...N.= mean(Peak.Landing.Force..Asym...N.,na.rm=TRUE),
            Peak.Power..W.= mean(Peak.Power..W.,na.rm=TRUE),
            Concentric.Maximum.RFD..N.s.= mean(Concentric.Maximum.RFD..N.s.,na.rm=TRUE),
            Concentric.Maximum.RFD..Right...N.s.= mean(Concentric.Maximum.RFD..Right...N.s.,na.rm=TRUE),
            Concentric.Maximum.RFD..Left...N.s.= mean(Concentric.Maximum.RFD..Left...N.s.,na.rm=TRUE),
            Eccentric.Mean.Braking.Force..N.= mean(Eccentric.Mean.Braking.Force..N.,na.rm=TRUE),
            Max.Jump.Height..cm.= mean(Max.Jump.Height..cm.,na.rm=TRUE),
            Max.Concentric.Peak.Force..N.= mean(Max.Concentric.Peak.Force..N.,na.rm=TRUE),
            Relative.Concentric.Power.Bilateral= mean(Relative.Concentric.Power.Bilateral,na.rm=TRUE),
            Relative.Eccentric.Power.Bilateral= mean(Relative.Eccentric.Power.Bilateral,na.rm=TRUE),
            Max.Peak.Power...BM= mean(Max.Peak.Power...BM,na.rm=TRUE),
            Max.Eccentric.Peak.Force..N.= mean(Max.Eccentric.Peak.Force..N.,na.rm=TRUE),
            Max.RSI.Modified.VALD= mean(Max.RSI.Modified.VALD,na.rm=TRUE),
            Max.Concentric.RPD..N.s.= mean(Max.Concentric.RPD..N.s.,na.rm=TRUE),
            Max.Concentric.Peak.Velocity..m.s.= mean(Max.Concentric.Peak.Velocity..m.s.,na.rm=TRUE),
            Max.Eccentric.Peak.Velocity..m.s.= mean(Max.Eccentric.Peak.Velocity..m.s.,na.rm=TRUE),
            Max.Peak.Landing.Force..N.= mean(Max.Peak.Landing.Force..N.,na.rm=TRUE),
            MAX.Concentric.Peak.Power..W.= mean(MAX.Concentric.Peak.Power..W.,na.rm=TRUE),
            Max.CMJ.Jump.Height..cm.= mean(Max.CMJ.Jump.Height..cm.,na.rm=TRUE),
            Max.CMJ.RSI.Modified..m.s.= mean(Max.CMJ.RSI.Modified..m.s.,na.rm=TRUE),
            Max.CMJ.Concentric.RPD..N.s.= mean(Max.CMJ.Concentric.RPD..N.s.,na.rm=TRUE),
            Max.CMJ.Peak.Power..W.= mean(Max.CMJ.Peak.Power..W.,na.rm=TRUE),
            Max.CMJ.Peak.Landing.Force..N.= mean(Max.CMJ.Peak.Landing.Force..N.,na.rm=TRUE),
            CMJ.Concentric.Relative.Peak.Power...Difference.from.First= mean(CMJ.Concentric.Relative.Peak.Power...Difference.from.First,na.rm=TRUE),
            CMJ.Eccentric.Relative.Peak.Power...Difference.from.First= mean(CMJ.Eccentric.Relative.Peak.Power...Difference.from.First,na.rm=TRUE),
            Position= get_mode(Position),
            Eccentric.Asymmetry= get_mode(Eccentric.Asymmetry),
            Concentric.Asymmetry= get_mode(Concentric.Asymmetry),
            .groups = 'drop'
            
              )         # 1416 obs & 32 vars -> 1801 obs w/ Position Eccentric + Concentric Asymmetry

CMJ_vb <- CMJ_v %>%
  na.omit()   #508 obs & 32 vars  -> 173 obs w/ Position Eccentric + Concentric Asymmetry
```

```{r}
#2:TEST TYPE= IMTP
IMTP_V <- Forcedecks_V %>%
  filter(Test.Type=="IMTP") %>% #1241
  select("anon_id", "Date", "Baseline.Force..N.","Baseline.Force..Asym...N.", "Peak.Vertical.Force..N.", "Peak.Vertical.Force...BM..N.kg.", "Peak.Vertical.Force..Asym...N.", "RFD...50ms..N.s.", "RFD...50ms..Asym...N.s.", "RFD...100ms..N.s.", "RFD...100ms..Asym...N.s.", "RFD...150ms..N.s.", "RFD...150ms..Asym...N.s.", "RFD...200ms..N.s.", "RFD...200ms..Asym...N.s.", "Net.Peak.Vertical.Force..N.s.", "Net.Peak.Vertical.Force..Asym...N.s.", "Force.at.200ms...BM..N.kg.", "Eccentric.Asymmetry", "Concentric.Asymmetry","MEAN.Eccentric.Mean.Force.Left", "MEAN.Eccentric.Mean.Force.Right", "MEAN.Concentric.Mean.Force.Left", "MEAN.Concentric.Mean.Force.Right", "MEAN.Concentric.Mean.Force.Asym", "MEAN.Peak.Landing.Force.Asym",  "MEAN.Relative.Peak.Power", "MEAN.CMJ.Concentric.Force", "MEAN.Peak.Landing.Force.Left", "MEAN.Peak.Landing.Force.Right", "DSI", "DSI.Bucket") %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()   #249 obs & 32 vars
```

```{r}
#3: TEST TYPE= HJ
HJ_V <- Forcedecks_V %>%
  filter(Test.Type=="HJ")  %>%  #367 obs
  select("anon_id", "Date", "Corrected.Standing.Weight..Kg.", "Mean.RSI..Flight.Contact.Time.", "Active.Stiffness..N.m.", "Best.Average.Force..N.", "Best.Average.Force..Asym...N.", "Best.Time.to.Peak.Force..ms.", "Best.Contact.Time..ms.", "Best.Flight.Time..ms.", "Best.Impulse..N.s.", "Best.Peak.Force..N.", "Best.Peak.Force..Asym...N.", "Mean.Average.Force..N.", "Mean.Average.Force..Asym...N.", "Mean.Landing.RFD..N.s.", "Mean.Landing.RFD..Asym...N.s.", "Stiffness.Fatigue....", "Stiffness.Fatigue..Asym.....", "Max.Jump.Height..cm.") %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()
                 #352 obs & 20 vars
```

4. VALD- Performance Test datasets
```{r}
Performance_B <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - Performance Test WBB.csv")
Performance_S <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - Performance Test WSOC.csv")
Performance_L <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - Performance Test WLAx (1).csv")
Performance_V <- read.csv("~/T2P2-data-analysis-2025/data-sets/VALD - Performance Test WVB.csv")
```
Of all performance datasets, only basketball and volleyball have positional norm information but are also missing a lot of positional information which makes this column sparse. None of the datasets contain rotational data or razor data. Contain small amounts of iso prone data.

#Basketball preformance data 
```{r}
#selects variables of interest, nordic and hip data, and cleans up position variable
performance_B <- subset(Performance_B, select = c('anon_id', 'Date', 'Athlete.Bodyweight..kg.','Sport.Position', 'Side', 'Repetitions', 'Maximum.Force', 'Average.Force', 'Impulse', 'Nordic.Left.MEAN', 'Nordic.Right.MEAN', 'Nordic.MEAN.Imbalance', 'Nordic.Left.MAX', 'Nordic.Right.MAX', 'Nordic.MAX.Imbalance', 'Trend', 'Nordic...Difference.from.First.Test', 'Maximum.Nordic.Bilateral.Mean', 'Relative.Maximum.Nordic.Bilateral.Mean', 'Hip.Abd.Left.MEAN', 'Hip.Abd.Right.MEAN', 'Hip.Abduction.MEAN.Imbalance', 'Hip.Abd.Left.MAX', 'Hip.Abd.Right.MAX', 'Hip.Abduction.MAX.Imbalance', 'Hip.Add.Left.MEAN', 'Hip.Add.Right.MEAN', 'Hip.Adduction.MEAN.Imbalance', 'Hip.Add.Left.MAX', 'Hip.Add.Right.MAX', 'Hip.Adduction.MAX.Imbalance', 'Bilateral.Hip.Abduction.Adduction.Ratio')) %>%
  mutate(Position = case_when(
    Sport.Position == '' ~ 'None',
    Sport.Position == '|Guard' ~ 'Guard',
    str_detect(Sport.Position, "Primary:") ~ 'Forward',
    TRUE ~ Sport.Position
  )) %>%
  select(-Sport.Position)

#makes the date column a 'date' object for later and omits NA values for nordic dataset
performance_B_nordic <- performance_B %>%
  select(-c('Hip.Abd.Left.MEAN', 'Hip.Abd.Right.MEAN', 'Hip.Abduction.MEAN.Imbalance', 'Hip.Abd.Left.MAX', 'Hip.Abd.Right.MAX', 'Hip.Abduction.MAX.Imbalance', 'Hip.Add.Left.MEAN', 'Hip.Add.Right.MEAN', 'Hip.Adduction.MEAN.Imbalance', 'Hip.Add.Left.MAX', 'Hip.Add.Right.MAX', 'Hip.Adduction.MAX.Imbalance', 'Bilateral.Hip.Abduction.Adduction.Ratio')) %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()

#makes the date column a 'date' object for later and omits NA values for hip dataset
performance_B_hip <- performance_B %>%
  select(-c('Nordic.Left.MEAN', 'Nordic.Right.MEAN', 'Nordic.MEAN.Imbalance', 'Nordic.Left.MAX', 'Nordic.Right.MAX', 'Nordic.MAX.Imbalance', 'Trend', 'Nordic...Difference.from.First.Test', 'Maximum.Nordic.Bilateral.Mean', 'Relative.Maximum.Nordic.Bilateral.Mean')) %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()
```
Need to either get more data on positions of players or get rid of percent difference from norm since it has a lot of NAs. Could consider athlete bodyweight as well to put strength relatively but also has missing data and has negative values? Also missing a decent amount of z-score observations. 147 observations with percent difference norm and z-scores. 550 with only z-scores. 592 with neither percent difference norm or z-scores. If we include athlete bodyweight and exclude percent difference norm and z-scores there are 521 observations. 

Hip dataset contains 109 observations including the bodyweight variable, 129 otherwise. 

#Soccer preformance data
```{r}
#selects variables of interest, nordic and hip data, and cleans up position variable
performance_S <- subset(Performance_S, select = c('anon_id', 'Date', 'Athlete.Bodyweight..kg.','Sport.Position', 'Side', 'Repetitions', 'Maximum.Force', 'Average.Force', 'Impulse', 'Nordic.Left.MEAN', 'Nordic.Right.MEAN', 'Nordic.MEAN.Imbalance', 'Nordic.Left.MAX', 'Nordic.Right.MAX', 'Nordic.MAX.Imbalance', 'Trend', 'Nordic...Difference.from.First.Test', 'Maximum.Nordic.Bilateral.Mean', 'Relative.Maximum.Nordic.Bilateral.Mean', 'Hip.Abd.Left.MEAN', 'Hip.Abd.Right.MEAN', 'Hip.Abduction.MEAN.Imbalance', 'Hip.Abd.Left.MAX', 'Hip.Abd.Right.MAX', 'Hip.Abduction.MAX.Imbalance', 'Hip.Add.Left.MEAN', 'Hip.Add.Right.MEAN', 'Hip.Adduction.MEAN.Imbalance', 'Hip.Add.Left.MAX', 'Hip.Add.Right.MAX', 'Hip.Adduction.MAX.Imbalance', 'Bilateral.Hip.Abduction.Adduction.Ratio')) %>%
  mutate(Position = case_when(
    Sport.Position == '' ~ 'None',
    TRUE ~ Sport.Position
  )) %>%
  select(-Sport.Position)

#makes the date column a 'date' object for later and omits NA values for nordic dataset
performance_S_nordic <- performance_S %>%
  select(-c('Hip.Abd.Left.MEAN', 'Hip.Abd.Right.MEAN', 'Hip.Abduction.MEAN.Imbalance', 'Hip.Abd.Left.MAX', 'Hip.Abd.Right.MAX', 'Hip.Abduction.MAX.Imbalance', 'Hip.Add.Left.MEAN', 'Hip.Add.Right.MEAN', 'Hip.Adduction.MEAN.Imbalance', 'Hip.Add.Left.MAX', 'Hip.Add.Right.MAX', 'Hip.Adduction.MAX.Imbalance', 'Bilateral.Hip.Abduction.Adduction.Ratio')) %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()

#makes the date column a 'date' object for later and omits NA values for hip dataset
performance_S_hip <- performance_S %>%
  select(-c('Nordic.Left.MEAN', 'Nordic.Right.MEAN', 'Nordic.MEAN.Imbalance', 'Nordic.Left.MAX', 'Nordic.Right.MAX', 'Nordic.MAX.Imbalance', 'Trend', 'Nordic...Difference.from.First.Test', 'Maximum.Nordic.Bilateral.Mean', 'Relative.Maximum.Nordic.Bilateral.Mean')) %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()
```
Does not contain any information about positional norms so there are no percent differences from norm. 421 observations with z-scores. 483 observations without z-scores. There are 400 observations if bodyweight is included.  

Hip dataset contains only 39 observations with body weight included and without it included.

#Lacrosse preformance data
```{r}
#selects variables of interest, nordic and hip data, and cleans up position variable
performance_L <- subset(Performance_L, select = c('anon_id', 'Date', 'Athlete.Bodyweight..kg.','Sport.Position', 'Side', 'Repetitions', 'Maximum.Force', 'Average.Force', 'Impulse', 'Nordic.Left.MEAN', 'Nordic.Right.MEAN', 'Nordic.MEAN.Imbalance', 'Nordic.Left.MAX', 'Nordic.Right.MAX', 'Nordic.MAX.Imbalance', 'Trend', 'Nordic...Difference.from.First.Test', 'Maximum.Nordic.Bilateral.Mean', 'Relative.Maximum.Nordic.Bilateral.Mean', 'Hip.Abd.Left.MEAN', 'Hip.Abd.Right.MEAN', 'Hip.Abduction.MEAN.Imbalance', 'Hip.Abd.Left.MAX', 'Hip.Abd.Right.MAX', 'Hip.Abduction.MAX.Imbalance', 'Hip.Add.Left.MEAN', 'Hip.Add.Right.MEAN', 'Hip.Adduction.MEAN.Imbalance', 'Hip.Add.Left.MAX', 'Hip.Add.Right.MAX', 'Hip.Adduction.MAX.Imbalance', 'Bilateral.Hip.Abduction.Adduction.Ratio')) %>%
  mutate(Position = case_when(
    Sport.Position == '' ~ 'None',
    TRUE ~ Sport.Position
  )) %>%
  select(-Sport.Position)

#makes the date column a 'date' object for later and omits NA values for nordic dataset
performance_L_nordic <- performance_L %>%
  select(-c('Hip.Abd.Left.MEAN', 'Hip.Abd.Right.MEAN', 'Hip.Abduction.MEAN.Imbalance', 'Hip.Abd.Left.MAX', 'Hip.Abd.Right.MAX', 'Hip.Abduction.MAX.Imbalance', 'Hip.Add.Left.MEAN', 'Hip.Add.Right.MEAN', 'Hip.Adduction.MEAN.Imbalance', 'Hip.Add.Left.MAX', 'Hip.Add.Right.MAX', 'Hip.Adduction.MAX.Imbalance', 'Bilateral.Hip.Abduction.Adduction.Ratio')) %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()

#makes the date column a 'date' object for later and omits NA values for hip dataset
performance_L_hip <- performance_L %>%
  select(-c('Nordic.Left.MEAN', 'Nordic.Right.MEAN', 'Nordic.MEAN.Imbalance', 'Nordic.Left.MAX', 'Nordic.Right.MAX', 'Nordic.MAX.Imbalance', 'Trend', 'Nordic...Difference.from.First.Test', 'Maximum.Nordic.Bilateral.Mean', 'Relative.Maximum.Nordic.Bilateral.Mean')) %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()
```

Also does not contain any information about positional norms so there are no percent differences from norm. 855 observations with z-scores. 929 observations without z-scores. 810 observations if bodyweight is included.  

Hip dataset contains 100 observations with bodyweight included and excluded. 

#Volleyball preformance data
```{r}
#selects variables of interest, nordic and hip data
performance_V <- subset(Performance_V, select = c('anon_id', 'Date', 'Athlete.Bodyweight..kg.','Sport.Position', 'Side', 'Repetitions', 'Maximum.Force', 'Average.Force', 'Impulse', 'Nordic.Left.MEAN', 'Nordic.Right.MEAN', 'Nordic.MEAN.Imbalance', 'Nordic.Left.MAX', 'Nordic.Right.MAX', 'Nordic.MAX.Imbalance', 'Trend', 'Nordic...Difference.from.First.Test', 'Maximum.Nordic.Bilateral.Mean', 'Relative.Maximum.Nordic.Bilateral.Mean', 'Hip.Abd.Left.MEAN', 'Hip.Abd.Right.MEAN', 'Hip.Abduction.MEAN.Imbalance', 'Hip.Abd.Left.MAX', 'Hip.Abd.Right.MAX', 'Hip.Abduction.MAX.Imbalance', 'Hip.Add.Left.MEAN', 'Hip.Add.Right.MEAN', 'Hip.Adduction.MEAN.Imbalance', 'Hip.Add.Left.MAX', 'Hip.Add.Right.MAX', 'Hip.Adduction.MAX.Imbalance', 'Bilateral.Hip.Abduction.Adduction.Ratio')) %>%
  mutate(Position = case_when(
    Sport.Position == '' ~ 'None',
    TRUE ~ Sport.Position
  )) %>%
  select(-Sport.Position)

#makes the date column a 'date' object for later and omits NA values for nordic dataset
performance_V_nordic <- performance_V %>%
  select(-c('Hip.Abd.Left.MEAN', 'Hip.Abd.Right.MEAN', 'Hip.Abduction.MEAN.Imbalance', 'Hip.Abd.Left.MAX', 'Hip.Abd.Right.MAX', 'Hip.Abduction.MAX.Imbalance', 'Hip.Add.Left.MEAN', 'Hip.Add.Right.MEAN', 'Hip.Adduction.MEAN.Imbalance', 'Hip.Add.Left.MAX', 'Hip.Add.Right.MAX', 'Hip.Adduction.MAX.Imbalance', 'Bilateral.Hip.Abduction.Adduction.Ratio')) %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()

#makes the date column a 'date' object for later and omits NA values for hip dataset
performance_V_hip <- performance_V %>%
  select(-c('Nordic.Left.MEAN', 'Nordic.Right.MEAN', 'Nordic.MEAN.Imbalance', 'Nordic.Left.MAX', 'Nordic.Right.MAX', 'Nordic.MAX.Imbalance', 'Trend', 'Nordic...Difference.from.First.Test', 'Maximum.Nordic.Bilateral.Mean', 'Relative.Maximum.Nordic.Bilateral.Mean')) %>%
  mutate(Date = as.Date(Date, format = '%m/%d/%Y')) %>%
  na.omit()
```

There are a lot of observations with the player playing multiple positions, need to figure out how to filter down when analyzing data by positions. 

Does have positional norm information but a lot of missing values. Only 33 observations with percent difference norm and z-scores. 356 observations with only z-scores. 393 observations without either percent difference norm or z-scores. 325 observations if bodyweight is included.

Hip data contains 180 observations with bodyweight included, 220 otherwise.


## Exploratory Analysis 
1. Incident datasets
```{r}
#density plot of injuries across the different parts of a season  
ggplot(incident_b, aes(x=Season.))+
  geom_bar(fill="#CFB87C")+
  labs(title="Seasonal Injury Spread",x="Season",y="Frequency")

ggplot(incident_b, aes(x=General.mechanism))+
  geom_bar(fill="#CFB87C")+
  labs(title="Seasonal Injury Spread by Mechanism",x="Mechanism",y="Frequency")

ggplot(incident_b, aes(x=Position))+
  geom_bar(fill="#CFB87C")+
  labs(title="Positional Injury Spread",x="Players Positions",y="Frequency")
```
Contact injuries seem to be the biggest concern for womens basketball are focus of lower body injuries is typically non-contact. In-season is the biggest time for injuries in basketball.

```{r}
#density plot of injuries across the different parts of a season  
ggplot(incident_s, aes(x=Season.))+
  geom_bar(fill="#CFB87C")+
  labs(title="Seasonal Injury Spread",x="Season",y="Frequency")

ggplot(incident_s, aes(x=General.mechanism))+
  geom_bar(fill="#CFB87C")+
  labs(title="Seasonal Injury Spread by Mechanism",x="Mechanism",y="Frequency")

ggplot(incident_s, aes(x=Position))+
  geom_bar(fill="#CFB87C")+
  labs(title="Positional Injury Spread",x="Players Positions",y="Frequency")
```
Highest frequency of lower body injuries in-season but an unexpectedly high rate of lower body injuries in the off season as well. Contact injuries are 2x as likely as a non-contact injury. 

```{r}
#density plot of injuries across the different parts of a season  
ggplot(incident_v, aes(x=Season.))+
  geom_bar(fill="#CFB87C")+
  labs(title="Seasonal Injury Spread",x="Season",y="Frequency")

ggplot(incident_v, aes(x=General.mechanism))+
  geom_bar(fill="#CFB87C")+
  labs(title="Seasonal Injury Spread by Mechanism",x="Injury Mechanism",y="Frequency")

ggplot(incident_v, aes(x=Position))+
  geom_bar(fill="#CFB87C")+
  theme(axis.text.x=element_text(angle=45,hjust=1))+
  labs(title="Positional Injury Spread",x="Players Positions",y="Frequency")
```
This is the first sport that we see the highest lower body injury frequency as non-contact injury mechanism, higher probability of greater lower body injuries in volleyball then basketball and soccer.

```{r}
#density plot of injuries across the different parts of a season  
ggplot(incident_l, aes(x=Season.))+
  geom_bar(fill="#CFB87C")+
  labs(title="Seasonal Injury Spread",x="Season",y="Frequency")

ggplot(incident_l, aes(x=General.mechanism))+
  geom_bar(fill="#CFB87C")+
  labs(title="Seasonal Injury Spread by Mechanism",x="Mechanism",y="Frequency")

ggplot(incident_l, aes(x=Position))+
  geom_bar(fill="#CFB87C")+
  labs(title="Positional Injury Spread",x="Players Positions",y="Frequency")
```
Like volleyball strong lead of non-contact injuries then any other type of injury mechanism.

2. Dynamo
-NO PLOTS ATM

3. Forcedecks 
Variable Distribution Plots
```{r}
#basketball, CMJ test: distribution of max RSI
ggplot(CMJ_bb, aes(Max.CMJ.RSI.Modified..m.s.)) +
  labs(title="Distribution of Maximum RSI in CMJ Test",x="RSI", y="Frequency") +
  geom_histogram(fill="#CFB87C")

#HJ TEST: distribution of Mean.RSI..Flight.Contact.Time 
ggplot(HJ_B, aes(Mean.RSI..Flight.Contact.Time.)) +
  labs(title="Distribution of RSI Flight Contact Time in the Hop Jump Test",x="Average RSI Flight Contact Time", y="Frequency") +
  geom_histogram(fill="#CFB87C")

#IMTP test: distribution of peak vert. force
ggplot(IMTP_B, aes(Net.Peak.Vertical.Force..N.s.)) +
  labs(title="Distribution of IMTP Test",x="Peak Vertical Force", y="Frequency") +
  geom_histogram(fill="#CFB87C")
```

```{r}
#SOCCER, CMJ test: distribution of max RSI 
ggplot(CMJ_soc, aes(Max.CMJ.RSI.Modified..m.s.)) +
  labs(title="Distribution of Maximum RSI in CMJ Test",x="RSI", y="Frequency") +
  geom_histogram(fill="#CFB87C")

#HJ TEST: distribution of Mean.RSI..Flight.Contact.Time 
ggplot(HJ_S, aes(Mean.RSI..Flight.Contact.Time.)) +
  labs(title="Distribution of RSI Flight Contact Time in the Hop Jump Test",x="Average RSI Flight Contact Time", y="Frequency") +
  geom_histogram(fill="#CFB87C")

#IMTP test: distribution of peak vert. force
ggplot(IMTP_S, aes(Net.Peak.Vertical.Force..N.s.)) +
  labs(title="Distribution of IMTP Test",x="Peak Vertical Force", y="Frequency") +
  geom_histogram(fill="#CFB87C")

#SLJ test: distribution  
ggplot(SLJ_S, aes(Concentric.Impulse..Ns.)) +
  labs(title="Distribution of Concentric Impulse in SLJ Test",x="Concentric Impulse", y="Frequency") +
  geom_histogram(fill="#CFB87C")
```

```{r}
#LACROSSE, CMJ test: distribution of max RSI 
ggplot(CMJ_lax, aes(Max.CMJ.RSI.Modified..m.s.)) +
  labs(title="Distribution of Maximum RSI in CMJ Test",x="RSI", y="Frequency") +
  geom_histogram(fill="#CFB87C")

#HJ TEST: distribution of Mean.RSI..Flight.Contact.Time 
ggplot(HJ_L, aes(Mean.RSI..Flight.Contact.Time.)) +
  labs(title="Distribution of RSI Flight Contact Time in the Hop Jump Test",x="Average RSI Flight Contact Time", y="Frequency") +
  geom_histogram(fill="#CFB87C")

#IMTP test: distribution of peak vert. force
ggplot(IMTP_L, aes(Net.Peak.Vertical.Force..N.s.)) +
  labs(title="Distribution of IMTP Test",x="Peak Vertical Force", y="Frequency") +
  geom_histogram(fill="#CFB87C")

#SLJ test: distribution  
ggplot(SLJ_L, aes(Concentric.Impulse..Ns.)) +
  labs(title="Distribution of Concentric Impulse in SLJ Test",x="Concentric Impulse", y="Frequency") +
  geom_histogram(fill="#CFB87C")
```

```{r}
#VOLLEYBALL, CMJ test: distribution of max RSI 
ggplot(CMJ_vb, aes(Max.CMJ.RSI.Modified..m.s.)) +
  labs(title="Distribution of Maximum RSI in CMJ Test",x="RSI", y="Frequency") +
  geom_histogram(fill="#CFB87C")

#HJ TEST: distribution of Mean.RSI..Flight.Contact.Time 
ggplot(HJ_V, aes(Mean.RSI..Flight.Contact.Time.)) +
  labs(title="Distribution of RSI Flight Contact Time in the Hop Jump Test",x="Average RSI Flight Contact Time", y="Frequency") +
  geom_histogram(fill="#CFB87C")

#IMTP test: distribution of peak vert. force
ggplot(IMTP_V, aes(Net.Peak.Vertical.Force..N.s.)) +
  labs(title="Distribution of IMTP Test",x="Peak Vertical Force", y="Frequency") +
  geom_histogram(fill="#CFB87C")
```

4. Performance 
```{r}
#summarizes the number of unique athletes per position group
performance_B_nordic %>%
  group_by(Position) %>%
  summarize(`Unique Athletes` = n_distinct(anon_id))
```
There are only 4 unique centers represented with most of the observations being ID_40 and ID_51, ID_15 and ID_30 each only have one observation. Forwards only have 8 unique players but the split between these players is more even with the exception of ID_24 who only has one observation. Guards has 10 unique players with ID_55 making up a large proportion of these observations and ID_5, ID_54, and ID_63 only being represented once. 

```{r}
#creates a boxplot of maximum relative bilateral force across the basketball positions
ggplot(performance_B_nordic, aes(x = Relative.Maximum.Nordic.Bilateral.Mean, y = Position)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of Maximum Relative Bilateral Force Across Basketball Postions',
       y = 'Position',
       x = 'Maximum Relative Bilateral Force (N / kg)') +
  theme_bw()
```

Centers appear to have a far greater variability in force along with a lower median of force in comparison to forwards and guards. The same appears to be true for the relative force. Interestingly when plotting the athlete bodyweight vs position there is no signifiant differences and the median weight for centers is less than the median weight of guards and forwards.

```{r}
#creates a correlation matrix of all numerical values
cor(performance_B_nordic[,-c(1, 2, 4, 5, 15, 19, 20)])
```
Interestingly bodyweight is most correlated with maximum force. Also interestingly Maximum.Force is equal to Nordic.Left.MAX and Average.Force is equal to Nordic.Left.MEAn, is this supposed to be the case? Not a whole lot of colinearity otherwise.
```{r}
#summarizes the number of unique athletes per position group
performance_S_nordic %>%
  group_by(Position) %>%
  summarize(`Unique Athletes` = n_distinct(anon_id))
```

There are only one unique outside back and center back players. Only 4 defense midfield players with ID_32 only having one observation. Only 3 goalies, relatively even distribution of observations. 7 forwards, also pretty even distribution of observations. 7 midfeilders with ID_94 and ID_32 only representing one observation each. 

```{r}
#creates a boxplot of maximum relative bilateral force across the basketball positions
ggplot(performance_S_nordic, aes(x = Relative.Maximum.Nordic.Bilateral.Mean, y = Position)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of Maximum Relative Bilateral Force Across Basketball Postions',
       y = 'Position',
       x = 'Maximum Relative Bilateral Force (N / kg)') +
  theme_bw()
```
There is a big outlier in ID_3 whos mean maximum bilateral force in newtons was less than her bodyweight in kg.

```{r}
#creates a correlation matrix of all numerical values
cor(performance_S_nordic[,-c(1, 2, 4, 5, 15, 19, 20)])
```
Athlete bodyweight is less correlated with any strength measures.

```{r}
#summarizes the number of unique athletes per position group
performance_L_nordic %>%
  group_by(Position) %>%
  summarize(`Unique Athletes` = n_distinct(anon_id))
```
This dataset seems to have a better amount of unique players per position. 

```{r}
#creates a boxplot of maximum relative bilateral force across the basketball positions
ggplot(performance_L_nordic, aes(x = Relative.Maximum.Nordic.Bilateral.Mean, y = Position)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of Maximum Relative Bilateral Force Across Basketball Postions',
       y = 'Position',
       x = 'Maximum Relative Bilateral Force (N / kg)') +
  theme_bw()
```
All the positions seem to have a similar distribution of maximum relative bilateral force. 

```{r}
#creates a correlation matrix of all numerical values
cor(performance_L_nordic[,-c(1, 2, 4, 5, 15, 19, 20)])
```

```{r}
#summarizes the number of unique athletes per position group in preformance data 
performance_V_nordic %>%
  group_by(Position) %>%
  summarize(`Unique Athletes` = n_distinct(anon_id))
```
There are very few unique athletes per position in this dataset, need to figure out how we can assign two position athletes into one for better analysis of positions.  

```{r}
#creates a boxplot of maximum relative bilateral force across the basketball positions
ggplot(performance_V_nordic, aes(x = Relative.Maximum.Nordic.Bilateral.Mean, y = Position)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of Maximum Relative Bilateral Force Across Basketball Postions',
       y = 'Position',
       x = 'Maximum Relative Bilateral Force (N / kg)') +
  theme_bw()
```
Middle Blocker|Opposite looks like it would fit more into Middle Blocker, Libero|Defensive specialist looks like it could fit inot Libero. Opposite|Outside Hitter is harder to tell. 

```{r}
#creates a correlation matrix of all numerical values
cor(performance_V_nordic[,-c(1, 2, 4, 5, 15, 19, 20)])
```


##MERGE DATASETS 
-incident + performance (nordic + hip), forceframe (multiple tests)
-dynamo not to be added 
These are grouped by all data of each sport. Do not know if will use as we want to compare metrics across sports. Keep Just in case.
```{r}
#ALL BASKETBALL DATA incident_b(128) performance_B_hip(109) performance_B_nordic (521), CMJ_bb(194), HJ_B(409), IMTP_B (50)
basketball_merge <- merge(performance_B_nordic,performance_B_hip, by=c('anon_id','Date'), all=TRUE)
basket_merge <- merge(basketball_merge,incident_b, by=c('anon_id','Date'), all=TRUE)
bball_merge <- merge(basket_merge,HJ_B, by=c('anon_id','Date'), all=TRUE)
bb_merge <- merge(bball_merge,CMJ_bb, by=c('anon_id','Date'), all=TRUE)
bb_merge_full <- merge(bball_merge,IMTP_B, by=c('anon_id','Date'), all=TRUE)  #1092 by 110

#filter out duplicated rows 
```
```{r}
#ALL SOCCER DATA 
soccer_merge <- merge(performance_S_nordic,performance_S_hip, by=c('anon_id','Date'), all=TRUE)
soc_merge <- merge(soccer_merge,incident_s, by=c('anon_id','Date'), all=TRUE)
s_merge <- merge(soc_merge,HJ_S, by=c('anon_id','Date'), all=TRUE)
S_merge <- merge(s_merge,CMJ_soc, by=c('anon_id','Date'), all=TRUE)
soc_merge_full <- merge(S_merge,IMTP_S, by=c('anon_id','Date'), all=TRUE)   #1233 by 168
soccer_merge_full <- merge(soc_merge_full, SLJ_s, by=c('anon_id','Date'), all=TRUE)  #1233 by 168
#ALL LACROSSE DATA    
lacrosse_merge <- merge(performance_L_nordic,performance_L_hip, by=c('anon_id','Date'), all=TRUE)
lax_merge <- merge(lacrosse_merge,incident_l, by=c('anon_id','Date'), all=TRUE)
l_merge <- merge(lax_merge,HJ_L, by=c('anon_id','Date'), all=TRUE)
L_merge <- merge(l_merge,CMJ_lax, by=c('anon_id','Date'), all=TRUE)
lax_merge_full <- merge(L_merge,IMTP_L, by=c('anon_id','Date'), all=TRUE)   #1390 by 145
lacrosse_merge_full <- merge(lax_merge_full, SLJ_L, by=c('anon_id','Date'), all=TRUE) 
#ALL VOLLEYBALL DATA
volleyball_merge <- merge(performance_V_nordic,performance_V_hip, by=c('anon_id','Date'), all=TRUE)
vball_merge <- merge(volleyball_merge,incident_v, by=c('anon_id','Date'), all=TRUE)
vb_merge <- merge(vball_merge,HJ_V, by=c('anon_id','Date'), all=TRUE)
v_merge <- merge(vb_merge,CMJ_vb, by=c('anon_id','Date'), all=TRUE)
vball_merge_full <- merge(v_merge,IMTP_V, by=c('anon_id','Date'), all=TRUE)  #1140 by 143
#basketball incidents + tests 
B_incid_CMJtest <- merge(incident_b, CMJ_bb, by=c('anon_id'),all=TRUE) #1312 by 61 
B_incid_HJtest <- merge(incident_b, HJ_B, by=c('anon_id'),all=TRUE)    #2020 by 46
B_incid_IMTPtest <- merge(incident_b, IMTP_B, by=c('anon_id'),all=TRUE) #315 by 56

#soccer incidents + tests 
S_incid_CMJtest <- merge(incident_s, CMJ_soc, by=c('anon_id'),all=TRUE) #1911 by 63
S_incid_HJtest <- merge(incident_s, HJ_S, by=c('anon_id'),all=TRUE)    #3200 by 47
S_incid_IMTPtest <- merge(incident_s, IMTP_S, by=c('anon_id'),all=TRUE) #596 by 57
S_incid_SLJtest <- merge(incident_s, SLJ_S, by=c('anon_id'),all=TRUE)   #3723 by 52
```



##RESEARCH QUESTIONS*******
#Q1: What are meaningful thresholds for strength metrics as they relate to lower body injury risk? 
a. For example, one of our strength coaches uses 5 times body weight (kg) in Newtons for hamstring strength as a cutoff for injury risk. Is this supported by our data? 

-looking for meaningful strength metrics to lower body injury risk
-create thresholds for these metrics by each position in each sport
```{r}
#GIVEN 
#confirm or deny threshold of 5x bodyweight (kg) in N for hamstring strength for injury risk
performance_all_nordic <-  performance_all_nordic %>%
  mutate(strength_ratio=Maximum.Nordic.Bilateral.Mean/Athlete.Bodyweight..kg., #hamstring strength/weight
         above_threshold=ifelse(strength_ratio>= 5, 1,0))

performance_all_nordic_incident <- merge(performance_all_nordic, all_incident, by='anon_id',na.rm=TRUE)

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=performance_all_nordic_incident, family="binomial")
summary(model)
```
Above threshold having a negative estimate and being significant , means that being above the 5x threshold is associated with a reduction in injury odds. Therefore being above the threshold does relate to lower body risk.

Combining forcedecks data with incident data to compare injuries across all sports with forcedeck strength information.
```{r}
#merge all incident datasets
all_incident <- bind_rows(incident_b, incident_s, incident_v,incident_l) %>%
  select(-c(Incident.Type,Total.Time.Injured.1))

#make all merging datasets the same # if variables 
CMJ_bb <- CMJ_bb %>%
  select(-c(Test.Type))
CMJ_soc <- CMJ_soc %>%
  select(-c(Test.Type))
CMJ_lax <- CMJ_lax %>%
  select(-c(Test.Type))
```

```{r}
#create a dataset containing all CMJ test data across all sports
all_CMJ <- rbind(CMJ_bb, CMJ_soc, CMJ_lax, CMJ_vb) 
all_CMJ_incident <- merge(all_incident, all_CMJ,by=c('anon_id'), na.rm=TRUE) #3471 v 67

#create a dataset containing all HJ test data across all sports
all_hopjump <- rbind(HJ_B, HJ_S, HJ_L, HJ_V)
all_hopjump_incident <- merge(all_incident, all_hopjump,by=c('anon_id'), na.rm=TRUE)  #5597 v 47

#create a dataset containing all IMTP test data across all sports
all_IMTP <- rbind(IMTP_B, IMTP_S, IMTP_L, IMTP_V)
all_IMTP_incident <- merge(all_incident, all_IMTP,by=c('anon_id'), na.rm=TRUE) #1552 v 60

#create a dataset containing all SLJ test data across all sports
all_SLJ <- rbind(SLJ_s, SLJ_l) 
all_SLJ_incident <- merge(all_incident, all_SLJ,by=c('anon_id'), na.rm=TRUE)  #461 v 52
```

##FINDING MY OWN THRESHOLDS
#CMJ
1. Relative.Concentric.Power.Bilateral
```{r}
#way 1 to find threshold
library(cutpointr)
all_CMJ_incident$LB.Injury <- as.factor(all_CMJ_incident$LB.Injury)

#Error: "Relative.Concentric.Power.Bilateral", :method should be a function
cp <- cutpointr(all_CMJ_incident, Relative.Concentric.Power.Bilateral, LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Relative Concentric Power Bilateral the optimal cutpoint is 10.3 with a AUC of 0.5028, sensitivity of 0.721 and specificity of 0.3191.

```{r}
#way 2 to find threshold 
library(pROC)
#ROC object
roc_obj <- roc(response = all_CMJ_incident$LB.Injury,
               predictor = all_CMJ_incident$Relative.Concentric.Power.Bilateral, #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Relative Concentric Bilateral Power")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Relative Concentric Power Bilateral the optimal threshold was 10.85, with an AUC of 0.4972, sensitivity 0.5625726, and specificity 0.4707865.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_CMJ_incident <-  all_CMJ_incident %>%
  mutate(above_threshold=ifelse(Relative.Concentric.Power.Bilateral>= 10.3, 1,0))#add newfound threshold 

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_CMJ_incident, family="binomial")
summary(model)
```

2. Eccentric.Concentric.Mean.Force.Ratio
```{r}
library(cutpointr)
all_CMJ_incident$LB.Injury <- as.factor(all_CMJ_incident$LB.Injury)

cp <- cutpointr(all_CMJ_incident, Eccentric.Concentric.Mean.Force.Ratio , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Eccentric Concentric Mean Force Ratio the optimal cutpoint is 53.5025 with a AUC of 0.4938, sensitivity of 0.49398 and specificity of 0.6202.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_CMJ_incident$LB.Injury,
               predictor = all_CMJ_incident$Eccentric.Concentric.Mean.Force.Ratio , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Eccentric Concentric Mean Force Ratio")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Eccentric Concentric Mean Force Ratio the optimal threshold is 47.7145 with a AUC of 0.5062, sensitivity of 0.1666021 and specificity of 0.9157303.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_CMJ_incident <-  all_CMJ_incident %>%
  mutate(above_threshold=ifelse(Eccentric.Concentric.Mean.Force.Ratio>= 47.7145, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_CMJ_incident, family="binomial")
summary(model)
```

3. Maximum Jump Height
```{r}
library(cutpointr)
all_CMJ_incident$LB.Injury <- as.factor(all_CMJ_incident$LB.Injury)

cp <- cutpointr(all_CMJ_incident, Max.Jump.Height..cm. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Maximum Jump Height the optimal cutpoint is 41.379 with a AUC of 0.5063, sensitivity of 0.0957 and specificity of 09618.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_CMJ_incident$LB.Injury,
               predictor = all_CMJ_incident$Max.Jump.Height..cm. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Maximum Jump Height")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Maximum Jump Height the optimal threshold is 24.6 with a AUC of 0.4937, sensitivity of 0.07245254 and specificity of 0.9595506.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_CMJ_incident <-  all_CMJ_incident %>%
  mutate(above_threshold=ifelse(Max.Jump.Height..cm.>= 41.379, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_CMJ_incident, family="binomial")
summary(model)
```

4. Maximum Concentric RFD
```{r}
library(cutpointr)
all_CMJ_incident$LB.Injury <- as.factor(all_CMJ_incident$LB.Injury)

cp <- cutpointr(all_CMJ_incident, Max.Concentric.RPD..N.s. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Maximum Concentric RFD the optimal cutpoint is 15784.34 with a AUC of 0.527, sensitivity of 0.6034 and specificity of 0.4963.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_CMJ_incident$LB.Injury,
               predictor = all_CMJ_incident$Max.Concentric.RPD..N.s. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Maximum Concentric RFD")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Maximum Concentric RFD the optimal threshold is 15780.66 with a AUC of 0.527, sensitivity of 0.496313 and specificity of 0.6033708.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_CMJ_incident <-  all_CMJ_incident %>%
  mutate(above_threshold=ifelse(Max.Concentric.RPD..N.s.>= 15784.34, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_CMJ_incident, family="binomial")
summary(model)
```

5. Eccentric Mean Braking Force
```{r}
library(cutpointr)
all_CMJ_incident$LB.Injury <- as.factor(all_CMJ_incident$LB.Injury)

cp <- cutpointr(all_CMJ_incident, Eccentric.Mean.Braking.Force..N. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Eccentric Mean Braking Force the optimal cutpoint is 783.517 with a AUC of 0.5989, sensitivity of 0.7146 and specificity of 0.4572.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_CMJ_incident$LB.Injury,
               predictor = all_CMJ_incident$Eccentric.Mean.Braking.Force..N. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Eccentric Mean Braking Force")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Eccentric Mean Braking Force the optimal threshold is 783.4963 with a AUC of 0.5989, sensitivity of 0.4571871 and specificity of 0.7146067.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_CMJ_incident <-  all_CMJ_incident %>%
  mutate(above_threshold=ifelse(Eccentric.Mean.Braking.Force..N.>= 783.517, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_CMJ_incident, family="binomial")
summary(model)
```

6. Maximum VALD RSI
```{r}
library(cutpointr)
all_CMJ_incident$LB.Injury <- as.factor(all_CMJ_incident$LB.Injury)

cp <- cutpointr(all_CMJ_incident, Max.RSI.Modified.VALD , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Maximum VALD RSI the optimal cutpoint is 0.4 with a AUC of 0.5263, sensitivity of 0.6562 and specificity of 0.406.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_CMJ_incident$LB.Injury,
               predictor = all_CMJ_incident$Max.RSI.Modified.VALD , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Maximum VALD RSI")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Maximum VALD RSI the optimal threshold is 0.3995 with a AUC of 0.5263, sensitivity of 0.4060442 and specificity of 0.6561798.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_CMJ_incident <-  all_CMJ_incident %>%
  mutate(above_threshold=ifelse(Max.RSI.Modified.VALD>= 0.3995, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_CMJ_incident, family="binomial")
summary(model)
```


#Hop Jump
1.Maximum Jump Height
```{r}
library(cutpointr)
all_hopjump_incident$LB.Injury <- as.factor(all_hopjump_incident$LB.Injury)

cp <- cutpointr(all_hopjump_incident, Max.Jump.Height..cm. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Maximum Jump Height the optimal cutpoint is 25.489 with a AUC of 0.533, sensitivity of 0.5263 and specificity of 0.5342.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_hopjump_incident$LB.Injury,
               predictor = all_hopjump_incident$Max.Jump.Height..cm. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Maximum Jump Height")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Maximum Jump Height the optimal threshold is 25.4335 with a AUC of 0.533, sensitivity of 0.5341823 and specificity of 0.5263158.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_hopjump_incident <-  all_hopjump_incident %>%
  mutate(above_threshold=ifelse(Max.Jump.Height..cm.>= 25.489, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_hopjump_incident, family="binomial")
summary(model)
```

2.Mean RSI Flight Contact Time
```{r}
library(cutpointr)
all_hopjump_incident$LB.Injury <- as.factor(all_hopjump_incident$LB.Injury)

cp <- cutpointr(all_hopjump_incident, Mean.RSI..Flight.Contact.Time. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Mean RSI Flight Contact Time the optimal cutpoint is 2.441 with a AUC of 0.5086, sensitivity of 0.4017 and specificity of 0.6387.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_hopjump_incident$LB.Injury,
               predictor = all_hopjump_incident$Mean.RSI..Flight.Contact.Time. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Mean RSI Flight Contact Time")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Mean RSI Flight Contact Time the optimal threshold is 1.8 with a AUC of 0.4914, sensitivity of 0.1646559 and specificity of 0.8599465.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_hopjump_incident <-  all_hopjump_incident %>%
  mutate(above_threshold=ifelse(Mean.RSI..Flight.Contact.Time.>= 2.441, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_hopjump_incident, family="binomial")
summary(model)
```

3.Best Contact Time
```{r}
library(cutpointr)
all_hopjump_incident$LB.Injury <- as.factor(all_hopjump_incident$LB.Injury)

cp <- cutpointr(all_hopjump_incident, Best.Contact.Time..ms. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Best Contact Time the optimal cutpoint is 0.184 with a AUC of 0.5442, sensitivity of 0.6949 and specificity of 0.4227.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_hopjump_incident$LB.Injury,
               predictor = all_hopjump_incident$Best.Contact.Time..ms. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Best Contact Time")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Best Contact Time the optimal threshold is 0.1835 with a AUC of 0.5442 , sensitivity of 0.4226988 and specificity of 0.6949153.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_hopjump_incident <-  all_hopjump_incident %>%
  mutate(above_threshold=ifelse(Best.Contact.Time..ms.>= 0.184, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_hopjump_incident, family="binomial")
summary(model)
```

#Isometric Mid Thigh Pull
1. Peak Vertical Force
```{r}
library(cutpointr)
all_IMTP_incident$LB.Injury <- as.factor(all_IMTP_incident$LB.Injury)

cp <- cutpointr(all_IMTP_incident, Peak.Vertical.Force...BM..N.kg. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
ForPeak Vertical Force the optimal cutpoint is 30.813 with a AUC of 0.5116, sensitivity of 0.8214 and specificity of 0.2596.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_IMTP_incident$LB.Injury,
               predictor = all_IMTP_incident$Peak.Vertical.Force...BM..N.kg. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Peak Vertical Force")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Peak Vertical Forc the optimal threshold is 30.5455 with a AUC of 0.5116 , sensitivity of 0.2596463 and specificity of 0.8214286.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_IMTP_incident <-  all_IMTP_incident %>%
  mutate(above_threshold=ifelse(Peak.Vertical.Force...BM..N.kg.>= 30.813, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_IMTP_incident, family="binomial")
summary(model)
```

2.RPD at 200ms
```{r}
library(cutpointr)
all_IMTP_incident$LB.Injury <- as.factor(all_IMTP_incident$LB.Injury)

cp <- cutpointr(all_IMTP_incident, RFD...200ms..N.s. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For RPD at 200ms the optimal cutpoint is 4032.637 with a AUC of 0.5208, sensitivity of 0.3006 and specificity of 0.7792.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_IMTP_incident$LB.Injury,
               predictor = all_IMTP_incident$RFD...200ms..N.s. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - RPD at 200ms")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For RPD at 200ms the optimal threshold is 8357.859 with a AUC of 0.4792 , sensitivity of 0.9766881 and specificity of 0.07792208.  

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_IMTP_incident <-  all_IMTP_incident %>%
  mutate(above_threshold=ifelse(RFD...200ms..N.s.>= 8357.859, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_IMTP_incident, family="binomial")
summary(model)
```

3. Force at 200ms
```{r}
library(cutpointr)
all_IMTP_incident$LB.Injury <- as.factor(all_IMTP_incident$LB.Injury)

cp <- cutpointr(all_IMTP_incident, Force.at.200ms...BM..N.kg. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Force at 200ms the optimal cutpoint is 24.254 with a AUC of 0.507, sensitivity of 0.3714 and specificity of 0.7078.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_IMTP_incident$LB.Injury,
               predictor = all_IMTP_incident$Force.at.200ms...BM..N.kg. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Force at 200ms")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Force at 200ms the optimal threshold is 17.6205 with a AUC of 0.493 , sensitivity of 0.312701 and specificity of 0.7402597.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_IMTP_incident <-  all_IMTP_incident %>%
  mutate(above_threshold=ifelse(Force.at.200ms...BM..N.kg.>= 24.254, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_IMTP_incident, family="binomial")
summary(model)
```

4. DSI
```{r}
library(cutpointr)
all_IMTP_incident$LB.Injury <- as.factor(all_IMTP_incident$LB.Injury)

cp <- cutpointr(all_IMTP_incident, DSI , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For DSI the optimal cutpoint is 0.59 with a AUC of 0.5005, sensitivity of 0.2291 and specificity of 0.8571.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_IMTP_incident$LB.Injury,
               predictor = all_IMTP_incident$DSI , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Dynamic Strength Index")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For DSI the optimal threshold is 0.235 with a AUC of 0.4995 , sensitivity of 0.2580386 and specificity of 0.8116883.

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_IMTP_incident <-  all_IMTP_incident %>%
  mutate(above_threshold=ifelse(DSI>= 0.59, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_IMTP_incident, family="binomial")
summary(model)
```

#Single Leg Jump
1.Maximum Jump Height
```{r}
library(cutpointr)
all_SLJ_incident$LB.Injury <- as.factor(all_SLJ_incident$LB.Injury)

cp <- cutpointr(all_SLJ_incident, Max.Jump.Height..cm. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Maximum Jump Height the optimal cutpoint is 19.223 with a AUC of 0.6147, sensitivity of 0.3625 and specificity of 0.8889.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_SLJ_incident$LB.Injury,
               predictor = all_SLJ_incident$Max.Jump.Height..cm. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Maximum Jump Height")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Maximum Jump Height the optimal threshold is 24.953 with a AUC of 0.3853 , sensitivity of 0.9897172 and specificity of 0.02777778.   

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_SLJ_incident <-  all_SLJ_incident %>%
  mutate(above_threshold=ifelse(Max.Jump.Height..cm.>= 19.223, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_SLJ_incident, family="binomial")
summary(model)
```

2.Jump Height Flight Time
```{r}
library(cutpointr)
all_SLJ_incident$LB.Injury <- as.factor(all_SLJ_incident$LB.Injury)

cp <- cutpointr(all_SLJ_incident, Jump.Height..Flight.Time...cm. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Jump Height Flight Time the optimal cutpoint is 17.027 with a AUC of 0.5904, sensitivity of 0.3265 and specificity of 0.875.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_SLJ_incident$LB.Injury,
               predictor = all_SLJ_incident$Jump.Height..Flight.Time...cm. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Jump Height Flight Time")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Jump Height Flight Time the optimal threshold is 23.40658 with a AUC of 0.4096 , sensitivity of 0.9897172 and specificity of 0.02777778.     17.027

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_SLJ_incident <-  all_SLJ_incident %>%
  mutate(above_threshold=ifelse(Jump.Height..Flight.Time...cm.>= 17.027, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_SLJ_incident, family="binomial")
summary(model)
```

3.Landing RPD
```{r}
library(cutpointr)
all_SLJ_incident$LB.Injury <- as.factor(all_SLJ_incident$LB.Injury)

cp <- cutpointr(all_SLJ_incident, Landing.RFD..N.s. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Landing RPD the optimal cutpoint is =31061.16 with a AUC of 0.5347, sensitivity of 0.4987 and specificity of 0.6806.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_SLJ_incident$LB.Injury,
               predictor = all_SLJ_incident$Landing.RFD..N.s. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Landing RPD")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Landing RPD the optimal threshold is 24395.01 with a AUC of 0.4653 , sensitivity of 0.1491003 and specificity of 0.9444444.     

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_SLJ_incident <-  all_SLJ_incident %>%
  mutate(above_threshold=ifelse(Landing.RFD..N.s.>= 31061.16, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_SLJ_incident, family="binomial")
summary(model)
```

4.Maximum Concentric Peak Force
```{r}
library(cutpointr)
all_SLJ_incident$LB.Injury <- as.factor(all_SLJ_incident$LB.Injury)

cp <- cutpointr(all_SLJ_incident, Max.Concentric.Peak.Force..N. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Maximum Concentric Peak Force the optimal cutpoint is 1243.319 with a AUC of 0.546, sensitivity of 0.8149 and specificity of 0.3611.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_SLJ_incident$LB.Injury,
               predictor = all_SLJ_incident$Max.Concentric.Peak.Force..N. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Maximum Concentric Peak Force")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Maximum Concentric Peak Force the optimal threshold is 1678.094 with a AUC of 0.454 , sensitivity of 0.8843188 and specificity of 0.1944444.     

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_SLJ_incident <-  all_SLJ_incident %>%
  mutate(above_threshold=ifelse(Max.Concentric.Peak.Force..N.>= 1243.319, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_SLJ_incident, family="binomial")
summary(model)
```

5.Concentric Impulse
```{r}
library(cutpointr)
all_SLJ_incident$LB.Injury <- as.factor(all_SLJ_incident$LB.Injury)

cp <- cutpointr(all_SLJ_incident, Concentric.Impulse..Ns. , LB.Injury, method=maximize_metric, metric=youden)
plot(cp)
summary(cp)
```
For Concentric Impulse the optimal cutpoint is 123.136 with a AUC of 0.5224, sensitivity of 0.1954 and specificity of 0.9306.

```{r}
library(pROC)
#ROC object
roc_obj <- roc(response = all_SLJ_incident$LB.Injury,
               predictor = all_SLJ_incident$Concentric.Impulse..Ns. , #power
               direction = ">")  # use "<" if higher values= high risk predict 'No'
               # if > rel. con. power then lower risk
#plot curve
plot(roc_obj, main = "ROC Curve - Concentric Impulse")
auc_value <- auc(roc_obj)
print(auc_value)
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"), best.method = "youden")
best_coords

#plot + threshold
plot(roc_obj, main = "ROC Curve with Optimal Threshold")
abline(a = 0, b = 1, lty = 2, col = "gray")
points(1 - best_coords["specificity"], best_coords["sensitivity"], col = '#CFB87C', pch = 19)
text(1 - best_coords["specificity"], best_coords["sensitivity"],
     labels = paste("Threshold =", round(best_coords["threshold"], 2)), pos = 4)
```
For Concentric Impulse the optimal threshold is 94.20375 with a AUC of 0.4776 , sensitivity of 0.1285347 and specificity of 0.9305556.    123.136

```{r}
#look at/discover/create more meaningful thresholds for strength metrics relating to LB injury risk, then test confirm threshold is valuable + interpret
all_SLJ_incident <-  all_SLJ_incident %>%
  mutate(above_threshold=ifelse(Concentric.Impulse..Ns.>= 123.136, 1,0))#add newfound threshold

#Does being above the threshold relate to lower body injury risk?
model <- glm(LB.Injury~ above_threshold,data=all_SLJ_incident, family="binomial")
summary(model)
```



#Q2:What trends in strength do we see across the womens team sports? 
a. Soccer, lacrosse, volleyball, basketball.
```{r}
#make a categorical variable including each injury to plot together  
#1= LB.Injury, 2=HSI, 3=ACL
all_incident$InjuryType <- with(all_incident, 
                          ifelse(ACL == 1, "ACL",
                          ifelse(HSI == 1, "HSI",
                          ifelse(LB.Injury  == 1, "Lower body", NA))))

#convert to factor 
all_incident$InjuryType <- factor(all_incident$InjuryType, levels = c("Lower body", "HSI", "ACL"))

 #now in data only keep those 3 injuries
all_incid <- all_incident[all_incident$Body.Part. %in% c("Thigh", "Ankle", "Lower leg", "Knee", "Foot", "Groin/hip"),]
```

```{r}
#plot count on y axis, then x= each sport , fill each injury 
  ggplot(data=all_incid, aes(x=Sport, fill=InjuryType))+
  geom_bar(na.rm=TRUE) +
  scale_fill_manual(values=c("Lower body"='#CFB87C',
                             "HSI"='white',
                             "ACL"='black')) +
  labs(title="The Number of Each Injury by Sport",
       y="Count",
       x="Sport",
       fill="Injury Type") +
  theme_minimal()
```

```{r}
#recurrence of injury plot 
ggplot(all_incident, aes(x=Sport, fill=Recurrence.of.Injury))+
  geom_bar(na.rm=TRUE) +
  scale_fill_manual(values=c("New Injury/Illness"='#CFB87C',
                             "First recurrence"='black',
                             "Multiple recurrence"='white',
                             "Pre-existing injury/illness"= 'grey')) +
  labs(title="The Number of Each Injury Recurrence by Sport",
       y="Count",
       x="Sport",
       fill="Recurrence") +
  theme_minimal()

#DSI bucket plot 
ggplot(all_IMTP_incident, aes(x=Sport, fill=DSI.Bucket))+
  geom_bar(na.rm=TRUE) +
  scale_fill_manual(values=c("Maximal Strength Training"='black',
                             "Concurrent Training"='white',
                             "Ballistic Strength Training"='#CFB87C')) +
  labs(title="The Number of Each DSI Bucket by Sport",
       y="Count",
       x="Sport",
       fill="DSI Bucket") +
  theme_minimal()
```
As seen in the past project with the football data, the main type of injury is a new injury, which makes it much harder to prevent or predict. Across all of the womens sports their focus is on ballistic strength training which emphasizes speed and explosiveness.

```{r}
#recurrence of injury over time line graph 
#scatterplot x= Dates color dots=recurrence 
ggplot(all_incident, aes(x = Start.of.Status, y = End.Date, color=Recurrence.of.Injury)) + 
  geom_point(position="jitter") + 
  geom_jitter(width = 2) +
  scale_x_date(date_breaks = '3 months') +
  labs(title = 'Recurrence of Injuries Over Time',
       x = 'Start of Injury Status',
       y = 'End of Injury Status') + 
  theme_bw()
```

```{r}
#sort Status only to out
injury_cumulative <- all_incident %>%
  filter(Status=="Out") %>%
  arrange(anon_id, Start.of.Status) %>%
  group_by(anon_id) %>%
  mutate(CumulativeInjuries = row_number())  # counts rows per player chronologically


ggplot(injury_cumulative, aes(x =CumulativeInjuries , y = Start.of.Status, color = as.factor(anon_id))) +
  geom_line() +
  labs(x = "Cumulative Injuries", y = "Injury Time Period", color = "Player ID") +
  theme_minimal()

#new
ggplot(injury_cumulative, aes(y = as.factor(anon_id))) +
  geom_segment(aes(x = Start.of.Status, xend = End.Date, yend = as.factor(anon_id),
                   color = Recurrence.of.Injury), size = 2) +
  labs(x = "Date", y = "Player ID", color = "Recurrence Type") +
  theme_minimal() +
  theme(legend.position = "bottom")

#newer
injury_data <- all_incident %>%
  filter(Status=="Out") %>%
  arrange(anon_id, Start.of.Status) %>%
  group_by(anon_id) %>%
  mutate(CumulativeInjuries = row_number())

ggplot(injury_data, aes(x = Start.of.Status, y = CumulativeInjuries, group = anon_id)) +
  geom_segment(aes(xend = End.Date, yend = CumulativeInjuries, color = Recurrence.of.Injury), size = 2) +
  geom_point(aes(color = Recurrence.of.Injury)) +
  labs(x = "Date", y = "Cumulative Injuries", color = "Recurrence Type") +
  theme_minimal()
```


1. CMJ + Incident 
```{r}
all_CMJ_incident <- all_CMJ_incident %>%
 mutate(Thresh = ifelse(Relative.Concentric.Power.Bilateral >= 0.5, 'Yes', 'No'))

#table with lower body injury on left and whether the observation is above/below threshold
table(all_CMJ_incident$LB.Injury, all_CMJ_incident$Thresh)

#boxplot
ggplot(all_CMJ_incident, aes(x = Relative.Concentric.Power.Bilateral, y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of Relative Concentric Bilateral Power Across Sports',
       y = 'Sport',
       x = 'Relative Concentric Bilateral Power') +
  theme_bw()
```

```{r}
#density plot 
ggplot(all_CMJ_incident, aes(x = Eccentric.Concentric.Mean.Force.Ratio, fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', '#666666', '#000000', '#8C7853')) +
  scale_color_manual(values = c('#CFB87C', '#666666', '#000000', '#8C7853')) +
  labs(title = 'Distribution of Eccentric Concentric Mean Force Ratio Across Sports',
       x = 'Eccentric Concentric Mean Force Ratio',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Eccentric.Concentric.Mean.Force.Ratio ~ Sport, data = all_CMJ_incident)
summary(anova_result)
TukeyHSD(anova_result)
```

```{r}
all_CMJ_incident <- all_CMJ_incident %>%
 mutate(Thresh0 = ifelse(Max.Jump.Height..cm. >= 0.5, 'Yes', 'No'))

#table with lower body injury on left and whether the observation is above/below threshold
table(all_CMJ_incident$LB.Injury, all_CMJ_incident$Thresh0)

#boxplot 
ggplot(all_CMJ_incident, aes(x = Max.Jump.Height..cm., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of Maximum Jump Height Across Sports',
       y = 'Sport',
       x = 'Maximum Jump Height (cm)') +
  theme_bw()

#density plot 
ggplot(all_CMJ_incident, aes(x = Max.Jump.Height..cm., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', '#666666', '#000000', '#8C7853')) +
  scale_color_manual(values = c('#CFB87C', '#666666', '#000000', '#8C7853')) +
  labs(title = 'Distribution of Maximum Jump Height (cm) Across Sports',
       x = 'Maximum Jump Height (cm)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Max.Jump.Height..cm. ~ Sport, data = all_CMJ_incident)
summary(anova_result)
```

```{r}
all_CMJ_incident <- all_CMJ_incident %>%
 mutate(Thresh1 = ifelse(Concentric.Maximum.RFD..N.s. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_CMJ_incident$LB.Injury, all_CMJ_incident$Thresh1)

#boxplot 
ggplot(all_CMJ_incident, aes(x = Concentric.Maximum.RFD..N.s., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Maximum Concentric RFD Across Sports',
       y = 'Sport',
       x = 'Maximum Concentric RFD (N/s)') +
  theme_bw()

#density plot 
ggplot(all_CMJ_incident, aes(x = Concentric.Maximum.RFD..N.s., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', '#666666', '#000000', '#8C7853')) +
  scale_color_manual(values = c('#CFB87C', '#666666', '#000000', '#8C7853')) +
  labs(title = 'Distribution of Maximum Concentric RFD (N/s) Across Sports',
       x = 'Maximum Concentric RFD (N/s)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Concentric.Maximum.RFD..N.s. ~ Sport, data = all_CMJ_incident)
summary(anova_result)
```

```{r}
all_CMJ_incident <- all_CMJ_incident %>%
 mutate(Thresh2 = ifelse(Eccentric.Mean.Braking.Force..N. >= 0.5, 'Yes', 'No'))

#table with lower body injury on left and whether the observation is above/below threshold
table(all_CMJ_incident$LB.Injury, all_CMJ_incident$Thresh2)

#boxplot 
ggplot(all_CMJ_incident, aes(x = Eccentric.Mean.Braking.Force..N., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Mean Eccentric Braking Force Across Sports',
       y = 'Sport',
       x = 'Mean Eccentric Braking Force (N)') +
  theme_bw()
```

```{r}
all_CMJ_incident <- all_CMJ_incident %>%
 mutate(Thresh3 = ifelse(Max.RSI.Modified.VALD>= 0.5, 'Yes', 'No'))

#table with lower body injury on left and whether the observation is above/below threshold
table(all_CMJ_incident$LB.Injury, all_CMJ_incident$Thresh3)

#boxplot 
ggplot(all_CMJ_incident, aes(x = Max.RSI.Modified.VALD, y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Maximum RSI from VALD Across Sports',
       y = 'Sport',
       x = 'Maximum RSI from VALD') +
  theme_bw()
```

2. Hop Jump + Incident 
```{r}
all_hopjump_incident <- all_hopjump_incident %>%
 mutate(Thresh = ifelse(Max.Jump.Height..cm. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_hopjump_incident$LB.Injury, all_hopjump_incident$Thresh)

#boxplot 
ggplot(all_hopjump_incident, aes(x = Max.Jump.Height..cm., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Maximum Jump Height (cm) Across Sports',
       y = 'Sport',
       x = 'Maximum Jump Height (cm)') +
  theme_bw()

#density plot 
ggplot(all_hopjump_incident, aes(x = Max.Jump.Height..cm., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', '#666666', '#000000', '#8C7853')) +
  scale_color_manual(values = c('#CFB87C', '#666666', '#000000', '#8C7853')) +
  labs(title = 'Distribution of Maximum Jump Height (cm) Across Sports',
       x = 'Maximum Jump Height (cm)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Max.Jump.Height..cm. ~ Sport, data = all_hopjump_incident)
summary(anova_result)
```

```{r}
all_hopjump_incident <- all_hopjump_incident %>%
 mutate(Thresh1 = ifelse(Mean.RSI..Flight.Contact.Time. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_hopjump_incident$LB.Injury, all_hopjump_incident$Thresh1)

#boxplot 
ggplot(all_hopjump_incident, aes(x = Mean.RSI..Flight.Contact.Time., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Average RSI Flight Contact Time Across Sports',
       y = 'Sport',
       x = 'Average RSI Flight Contact Time') +
  theme_bw()

#density plot 
ggplot(all_hopjump_incident, aes(x = Mean.RSI..Flight.Contact.Time., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', 'white', 'black','yellow')) +
  labs(title = 'Distribution of Average RSI Flight Contact Time Across Sports',
       x = 'Average RSI Flight Contact Time',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Mean.RSI..Flight.Contact.Time. ~ Sport, data = all_hopjump_incident)
summary(anova_result)
```

```{r}
all_hopjump_incident <- all_hopjump_incident %>%
 mutate(Thresh2 = ifelse(Best.Contact.Time..ms. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_hopjump_incident$LB.Injury, all_hopjump_incident$Thresh2)

#boxplot 
ggplot(all_hopjump_incident, aes(x = Best.Contact.Time..ms., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Best Contact Time (m/s) Across Sports',
       y = 'Sport',
       x = 'Best Contact Time (m/s)') +
  theme_bw()

#density plot 
ggplot(all_hopjump_incident, aes(x = Best.Contact.Time..ms., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', 'white', 'black','yellow')) +
  labs(title = 'Distribution of the Best Contact Time (m/s) Across Sports',
       x = 'Best Contact Time (m/s)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Best.Contact.Time..ms. ~ Sport, data = all_hopjump_incident)
summary(anova_result)
```

3. Isometric Mid Thigh Pull (IMTP) + Incident 
```{r}
#could use this or Peak.Vertical.Force..N. or Net.Peak.Vertical.Force..N.s.
all_IMTP_incident <- all_IMTP_incident %>%
 mutate(Thresh = ifelse(Peak.Vertical.Force...BM..N.kg. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_IMTP_incident$LB.Injury, all_IMTP_incident$Thresh)

#boxplot 
ggplot(all_IMTP_incident, aes(x = Peak.Vertical.Force...BM..N.kg., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Peak Vertical Force Across Sports',
       y = 'Sport',
       x = 'Peak Vertical Force (BM N/kg)') +
  theme_bw()

#density plot 
ggplot(all_IMTP_incident, aes(x = Peak.Vertical.Force...BM..N.kg., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', 'white', 'black','yellow')) +
  labs(title = 'Distribution of the Peak Vertical Force Across Sports',
       x = 'Peak Vertical Force (BM N/kg)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Peak.Vertical.Force...BM..N.kg. ~ Sport, data = all_IMTP_incident)
summary(anova_result)
```

```{r}
all_IMTP_incident <- all_IMTP_incident %>%
 mutate(Thresh1 = ifelse(RFD...200ms..N.s. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_IMTP_incident$LB.Injury, all_IMTP_incident$Thresh1)

#boxplot 
ggplot(all_IMTP_incident, aes(x = RFD...200ms..N.s., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Rate of Force Development at 200ms Across Sports',
       y = 'Sport',
       x = 'Rate of Force Development at 200ms (N/s)') +
  theme_bw()

#density plot 
ggplot(all_IMTP_incident, aes(x = RFD...200ms..N.s., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', 'white', 'black','yellow')) +
  labs(title = 'Distribution of the Rate of Force Development at 200ms Across Sports',
       x = 'Rate of Force Development at 200ms (N/s)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(RFD...200ms..N.s. ~ Sport, data = all_IMTP_incident)
summary(anova_result)
```

```{r}
all_IMTP_incident <- all_IMTP_incident %>%
 mutate(Thresh2 = ifelse(Force.at.200ms...BM..N.kg. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_IMTP_incident$LB.Injury, all_IMTP_incident$Thresh2)

#boxplot 
ggplot(all_IMTP_incident, aes(x = Force.at.200ms...BM..N.kg., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Force at 200ms Across Sports',
       y = 'Sport',
       x = 'Force at 200ms BM (N/kg)') +
  theme_bw()

#density plot 
ggplot(all_IMTP_incident, aes(x = Force.at.200ms...BM..N.kg., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', 'white', 'black','yellow')) +
  labs(title = 'Distribution of the Force at 200ms Across Sports',
       x = 'Force at 200ms BM (N/kg)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Force.at.200ms...BM..N.kg. ~ Sport, data = all_IMTP_incident)
summary(anova_result)
```

4. Single Leg Jump + Incident 
```{r}
all_SLJ_incident <- all_SLJ_incident %>%
 mutate(Thresh = ifelse(Max.Jump.Height..cm. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_SLJ_incident$LB.Injury, all_SLJ_incident$Thresh)

#boxplot 
ggplot(all_SLJ_incident, aes(x = Max.Jump.Height..cm., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Maximum Jump Height Across Sports',
       y = 'Sport',
       x = 'Maximum Jump Height (cm)') +
  theme_bw()

#density plot 
ggplot(all_SLJ_incident, aes(x = Max.Jump.Height..cm., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', 'white', 'black','yellow')) +
  labs(title = 'Distribution of the Maximum Jump Height Across Sports',
       x = 'Maximum Jump Height (cm)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Max.Jump.Height..cm. ~ Sport, data = all_SLJ_incident)
summary(anova_result)
```

```{r}
#CHOOSE TO KEEP THIS ONE OR ONE DIRECTLY ABOVE 
all_SLJ_incident <- all_SLJ_incident %>%
 mutate(Thresh1 = ifelse(Jump.Height..Flight.Time...cm. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_SLJ_incident$LB.Injury, all_SLJ_incident$Thresh1)

#boxplot 
ggplot(all_SLJ_incident, aes(x = Jump.Height..Flight.Time...cm., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Jump Height Flight Time Across Sports',
       y = 'Sport',
       x = 'Jump Height Flight Time (cm)') +
  theme_bw()

#density plot 
ggplot(all_SLJ_incident, aes(x = Jump.Height..Flight.Time...cm., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', 'white', 'black','yellow')) +
  labs(title = 'Distribution of the Jump Height Flight Time  Across Sports',
       x = 'Jump Height Flight Time (cm)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Jump.Height..Flight.Time...cm. ~ Sport, data = all_SLJ_incident)
summary(anova_result)
```

```{r}
all_SLJ_incident <- all_SLJ_incident %>%
 mutate(Thresh2 = ifelse(Landing.RFD..N.s. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_SLJ_incident$LB.Injury, all_SLJ_incident$Thresh2)

#boxplot 
ggplot(all_SLJ_incident, aes(x = Landing.RFD..N.s., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Landing Rate of Force Development Across Sports',
       y = 'Sport',
       x= 'Landing Rate of Force Development (N/s)') +
  theme_bw()

#density plot 
ggplot(all_SLJ_incident, aes(x = Landing.RFD..N.s., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', 'white', 'black','yellow')) +
  labs(title = 'Distribution of the Landing Rate of Force Development Across Sports',
       x = 'Landing Rate of Force Development (N/s)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Landing.RFD..N.s. ~ Sport, data = all_SLJ_incident)
summary(anova_result)
```

```{r}
all_SLJ_incident <- all_SLJ_incident %>%
 mutate(Thresh2 = ifelse(Max.Concentric.Peak.Force..N. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_SLJ_incident$LB.Injury, all_SLJ_incident$Thresh2)

#boxplot 
ggplot(all_SLJ_incident, aes(x = Max.Concentric.Peak.Force..N., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Maximum Concentric Peak Force Across Sports',
       y = 'Sport',
       x= 'Maximum Concentric Peak Force (N)') +
  theme_bw()

#density plot 
ggplot(all_SLJ_incident, aes(x = Max.Concentric.Peak.Force..N., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', 'white', 'black','yellow')) +
  labs(title = 'Distribution of the Maximum Concentric Peak Force Across Sports',
       x = 'Maximum Concentric Peak Force (N)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Max.Concentric.Peak.Force..N. ~ Sport, data = all_SLJ_incident)
summary(anova_result)
```

```{r}
all_SLJ_incident <- all_SLJ_incident %>%
 mutate(Thresh3 = ifelse(Concentric.Impulse..Ns. >= 0.5, 'Yes', 'No'))

#table w/ lower body injury on left and whether the observation is above/below threshold
table(all_SLJ_incident$LB.Injury, all_SLJ_incident$Thresh3)

#boxplot 
ggplot(all_SLJ_incident, aes(x = Max.Concentric.Peak.Force..N., y = Sport)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of the Concentric Impulse Across Sports',
       y = 'Sport',
       x= 'Concentric Impulse (N/s)') +
  theme_bw()

#density plot 
ggplot(all_SLJ_incident, aes(x = Concentric.Impulse..Ns., fill = Sport)) +
  geom_density(alpha = 0.4) + 
  scale_fill_manual(values = c('#CFB87C', 'white', 'black','yellow')) +
  labs(title = 'Distribution of the Concentric Impulse  Across Sports',
       x = 'Concentric Impulse (N/s)',
       y = 'Density') +
  theme_bw()

#anova test for differences
anova_result <- aov(Concentric.Impulse..Ns. ~ Sport, data = all_SLJ_incident)
summary(anova_result)
```







#All Time
Will have to look at the position of the players because without looking at position there is no association.

#In Relation to Injury Timelines- 6 months, 3 months aswell?
Looking 6 months in the past may be way too long need to figure out what window works best depending on which injuries. Also want to discuss if want to group by player and group and condense observations or just leave observations as is. 
**1. Basketball**
```{r}
#selects variables of interest, filters for lower body injuries, and gets rid of duplicate observations
incident_bb <- Incident_B %>%
  filter(Body.Part %in% lower_body) %>%
  select("anon_id", "Position", "Date.of.Injury...Onset.of.symptoms", "Side", "Body.Part", "Tissue.Type", "Pathology.Type", "OSICS14.Code", "OSICS10.Code", "OSICS10.Diagnosis", "Final.Diagnosis", "Result.of.Sport.Participation", "Recurrence.of.Injury", "Injury.Prognosis", "General.Mechanism", "Specific.Mechanism", "FinalDiagnosisIncidentDate", "Total.Time.Injured", "Season.") %>%
  group_by(anon_id, Date.of.Injury...Onset.of.symptoms) %>%
  mutate(Total.Time.Injured = sum(Total.Time.Injured, na.rm = TRUE),
         Season. = ifelse(Season. == 'Pre-Season' | Season. == 'Summer Workouts' | Season. == 'Post-Season', 'Off-Season', Season.),
         Date = as.Date(Date.of.Injury...Onset.of.symptoms, format = '%m/%d/%Y')) %>%
  ungroup() %>%
  group_by(across(everything())) %>%
  summarise(.groups = 'drop')
```

```{r, warning = FALSE}
#creates a dataset from the incident report that separates out all the dates for lower body injuries to classify observations based on their relation to lower body injuries: within 6 months prior to first injury, between first and second injury, ect.
last_injury_B <- incident_bb %>%
  arrange(Date) %>%
  group_by(anon_id) %>%
  summarize(Dates.Final = paste0(Date, collapse = " and "),
            Mechanism = paste0(General.Mechanism, collapse = " and "),
            Injury = paste0(Final.Diagnosis, collapse = " and "),
            Time.Injured = paste0(Total.Time.Injured, collapse = " and ")) %>%
  separate(Dates.Final, c('Injury.1', 'Injury.2', 'Injury.3', 'Injury.4'), sep = ' and ') %>%
  mutate(Injury.1.Start = as.Date(Injury.1) - months(1),
         Injury.2.Start = ifelse(is.na(Injury.2), NA, Injury.1),
         Injury.3.Start = ifelse(is.na(Injury.3), NA, Injury.2),
         Injury.4.Start = ifelse(is.na(Injury.4), NA, Injury.3)) %>%
  separate(Mechanism, c('Injury.1.Mech', 'Injury.2.Mech', 'Injury.3.Mech', 'Injury.4.Mech'), sep = ' and ') %>%
  separate(Injury, c('Injury.1.Diagnosis', 'Injury.2.Diagnosis', 'Injury.3.Diagnosis', 'Injury.4.Diagnosis'), sep = ' and ') %>%
  separate(Time.Injured, c('Injury.1.Time', 'Injury.2.Time', 'Injury.3.Time', 'Injury.4.Time'), sep = ' and ')
```

```{r}
#merges the last_injury_B to the performance_B_nordic by anon_id
merge_performance_B <- merge(last_injury_B, performance_B_nordic, by = c('anon_id'), all = TRUE)

#creates a variable called Group that groups based on date within injury intervals and outputs 'After' if the date is after all injuries, and then these are omitted
merge_performance_B <- merge_performance_B %>%
  mutate(Trend = ifelse(Trend == 'Neutral', 0, ifelse(Trend == 'Up', 1, -1)),
         Group = case_when(
    is.na(Injury.1) | Date < Injury.1.Start ~ '0',
    !is.na(Injury.1) & Date >= Injury.1.Start & Date <= Injury.1 ~ '1',
    !is.na(Injury.2) & Date >= Injury.2.Start & Date <= Injury.2 ~ '2',
    !is.na(Injury.3) & Date >= Injury.3.Start & Date <= Injury.3 ~ '3',
    !is.na(Injury.4) & Date >= Injury.4.Start & Date <= Injury.4 ~ '4',
    TRUE ~ 'After')) %>%
  filter(Group != 'After')

#condenses observations based on group and player summarizing means of variables of interest
merge_performance_B <- merge_performance_B %>%
  mutate(Injury = case_when(
    Group == 0 ~ 'None',
    Group == 1 ~ Injury.1.Diagnosis,
    Group == 2 ~ Injury.2.Diagnosis,
    Group == 3 ~ Injury.3.Diagnosis,
    Group == 4 ~ Injury.4.Diagnosis,
    TRUE ~ 'After'
  )) %>%
  mutate(Was.Injured = ifelse(Group == 1 | Group == 2 | Group == 3, 'Yes', Group))
```

```{r}
#creates a boxplot of maximum relative bilateral force across the basketball players
ggplot(merge_performance_B, aes(x = Relative.Maximum.Nordic.Bilateral.Mean, y = ACL)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of Maximum Relative Bilateral Force Across Basketball Players',
       y = 'Was the Player Injured',
       x = 'Maximum Relative Bilateral Force (N / kg)') +
  theme_bw()
```

In the Womens basketball dataset there is no performance data in the time prior to the only athlete to suffer an ACL rupture. 

**2. Soccer**
```{r}
#selects variables of interest, filters for lower body injuries, and gets rid of duplicate observations
incident_s <- Incident_S %>%
  filter(Body.Part %in% lower_body) %>%
  select("anon_id", "Position", "Date.of.Injury...Onset.of.symptoms", "Side", "Body.Part", "Tissue.Type", "Pathology.Type", "OSICS14.Code", "OSICS10.Code", "OSICS10.Diagnosis", "Final.Diagnosis", "Result.of.Sport.Participation", "Recurrence.of.Injury", "Injury.Prognosis", "General.Mechanism", "Specific.Mechanism", "FinalDiagnosisIncidentDate", "Total.Time.Injured", "Season.") %>%
  group_by(anon_id, Date.of.Injury...Onset.of.symptoms) %>%
  mutate(Total.Time.Injured = sum(Total.Time.Injured, na.rm = TRUE),
         Date = as.Date(Date.of.Injury...Onset.of.symptoms, format = '%m/%d/%Y'),
         Season. = ifelse(Season. == 'Pre-Season' | Season. == 'Summer Workouts' | Season. == 'Post-Season', 'Off-Season', Season.)) %>%
  ungroup() %>%
  group_by(across(everything())) %>%
  summarise(.groups = 'drop')

#get rid of duplicate observation with very small diagnosis differences
incident_s <- incident_s[-3,]
```

```{r, warning = FALSE}
#creates a dataset from the incident report that separates out all the dates for lower body injuries to classify observations based on their relation to lower body injuries: within 6 months prior to first injury, between first and second injury, ect.
last_injury_S <- incident_s %>%
  arrange(Date) %>%
  group_by(anon_id) %>%
  summarize(Dates.Final = paste0(Date, collapse = " and "),
            Mechanism = paste0(General.Mechanism, collapse = " and "),
            Injury = paste0(Final.Diagnosis, collapse = " and "),
            Time.Injured = paste0(Total.Time.Injured, collapse = " and ")) %>%
  separate(Dates.Final, c('Injury.1', 'Injury.2', 'Injury.3', 'Injury.4', 'Injury.5', 'Injury.6', 'Injury.7'), sep = ' and ') %>%
  mutate(Injury.1.Start = as.Date(Injury.1) - months(6),
         Injury.2.Start = ifelse(is.na(Injury.2), NA, Injury.1),
         Injury.3.Start = ifelse(is.na(Injury.3), NA, Injury.2),
         Injury.4.Start = ifelse(is.na(Injury.4), NA, Injury.3),
         Injury.5.Start = ifelse(is.na(Injury.4), NA, Injury.4),
         Injury.6.Start = ifelse(is.na(Injury.4), NA, Injury.5),
         Injury.7.Start = ifelse(is.na(Injury.4), NA, Injury.6)) %>%
  separate(Mechanism, c('Injury.1.Mech', 'Injury.2.Mech', 'Injury.3.Mech', 'Injury.4.Mech', 'Injury.5.Mech', 'Injury.6.Mech', 'Injury.7.Mech'), sep = ' and ') %>%
  separate(Injury, c('Injury.1.Diagnosis', 'Injury.2.Diagnosis', 'Injury.3.Diagnosis', 'Injury.4.Diagnosis', 'Injury.5.Diagnosis', 'Injury.6.Diagnosis', 'Injury.7.Diagnosis'), sep = ' and ') %>%
  separate(Time.Injured, c('Injury.1.Time', 'Injury.2.Time', 'Injury.3.Time', 'Injury.4.Time', 'Injury.5.Time', 'Injury.6.Time', 'Injury.7.Time'), sep = ' and ')
```

```{r}
#merges the last_injury_S to the performance_S_nordic by anon_id
merge_performance_S <- merge(last_injury_S, performance_S_nordic, by = c('anon_id'), all = TRUE)

#creates a variable called Group that groups based on date within injury intervals and outputs 'After' if the date is after all injuries, and then these are omitted
merge_performance_S <- merge_performance_S %>%
  mutate(Trend = ifelse(Trend == 'Neutral', 0, ifelse(Trend == 'Up', 1, -1)),
         Group = case_when(
    is.na(Injury.1) | Date < Injury.1.Start ~ '0',
    !is.na(Injury.1) & Date >= Injury.1.Start & Date <= Injury.1 ~ '1',
    !is.na(Injury.2) & Date >= Injury.2.Start & Date <= Injury.2 ~ '2',
    !is.na(Injury.3) & Date >= Injury.3.Start & Date <= Injury.3 ~ '3',
    !is.na(Injury.4) & Date >= Injury.4.Start & Date <= Injury.4 ~ '4',
    !is.na(Injury.5) & Date >= Injury.5.Start & Date <= Injury.5 ~ '5',
    !is.na(Injury.6) & Date >= Injury.6.Start & Date <= Injury.6 ~ '6',
    !is.na(Injury.7) & Date >= Injury.7.Start & Date <= Injury.7 ~ '7',
    TRUE ~ 'After')) %>%
  filter(Group != 'After')

#condenses observations based on group and player summarizing means of variables of interest
merge_performance_S <- merge_performance_S %>%
  mutate(Injury = case_when(
    Group == 0 ~ 'None',
    Group == 1 ~ Injury.1.Diagnosis,
    Group == 2 ~ Injury.2.Diagnosis,
    Group == 3 ~ Injury.3.Diagnosis,
    Group == 4 ~ Injury.4.Diagnosis,
    Group == 5 ~ Injury.1.Diagnosis,
    Group == 6 ~ Injury.2.Diagnosis,
    Group == 7 ~ Injury.3.Diagnosis,
    TRUE ~ 'After'
  )) %>%
  group_by(anon_id, Group, Injury) %>%
  summarise(Bodyweight.kg = mean(Athlete.Bodyweight..kg., na.rm = TRUE),
            Maximum.Force = mean(Maximum.Force, na.rm = TRUE),
            Average.Force = mean(Average.Force, na.rm = TRUE),
            Impulse = mean(Impulse, na.rm = TRUE),
            Nordic.MEAN.Imbalance = mean(Nordic.MEAN.Imbalance, na.rm = TRUE),
            Nordic.MAX.Imbalance = mean(Nordic.MAX.Imbalance, na.rm = TRUE),
            Trend = mean(Trend, na.rm = TRUE),
            Maximum.Nordic.Bilateral.Mean = mean(Maximum.Nordic.Bilateral.Mean, na.rm = TRUE),
            Relative.Maximum.Nordic.Bilateral.Mean = mean(Relative.Maximum.Nordic.Bilateral.Mean, na.rm = TRUE), .groups = 'drop') %>%
  mutate(Was.Injured = ifelse(Group == 1 | Group == 2 | Group == 3 | Group == 4 | Group == 5 | Group == 6 | Group == 7, 'Yes', Group))
```

```{r}
#creates a boxplot of maximum relative bilateral force across the soccer players
ggplot(merge_performance_S, aes(x = Relative.Maximum.Nordic.Bilateral.Mean, y = Was.Injured)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of Maximum Relative Bilateral Force Across Soccer Players',
       y = 'Was the Player Injured',
       x = 'Maximum Relative Bilateral Force (N / kg)') +
  theme_bw()
```

It appears from this graph that soccer athletes that were either didn't suffer a lower body injury or at a time before 6 months prior to an injury were, on average, weaker in terms of relative bilateral force in comparison to those who did have a lower body injury occur. 

**3. Lacrosse**
```{r}
#selects variables of interest, filters for lower body injuries, and gets rid of duplicate observations
incident_l <- Incident_L %>%
  filter(Body.Part %in% lower_body) %>%
  select("anon_id", "Position", "Date.of.Injury...Onset.of.symptoms", "Side", "Body.Part", "Tissue.Type", "Pathology.Type", "OSICS14.Code", "OSICS10.Code", "OSICS10.Diagnosis", "Final.Diagnosis", "Result.of.Sport.Participation", "Recurrence.of.Injury", "Injury.Prognosis", "General.Mechanism", "Specific.Mechanism", "FinalDiagnosisIncidentDate", "Total.Time.Injured", "Season.") %>%
  group_by(anon_id, Date.of.Injury...Onset.of.symptoms) %>%
  mutate(Total.Time.Injured = sum(Total.Time.Injured, na.rm = TRUE),
         Date = as.Date(Date.of.Injury...Onset.of.symptoms, format = '%m/%d/%Y'),
         Season. = ifelse(Season. == 'Pre-Season' | Season. == 'Summer Workouts' | Season. == 'Post-Season', 'Off-Season', Season.)) %>%
  ungroup() %>%
  group_by(across(everything())) %>%
  summarise(.groups = 'drop')
```

```{r, warning = FALSE}
#creates a dataset from the incident report that separates out all the dates for lower body injuries to classify observations based on their relation to lower body injuries: within 6 months prior to first injury, between first and second injury, ect.
last_injury_L <- incident_l %>%
  arrange(Date) %>%
  group_by(anon_id) %>%
  summarize(Dates.Final = paste0(Date, collapse = " and "),
            Mechanism = paste0(General.Mechanism, collapse = " and "),
            Injury = paste0(Final.Diagnosis, collapse = " and "),
            Time.Injured = paste0(Total.Time.Injured, collapse = " and ")) %>%
  separate(Dates.Final, c('Injury.1', 'Injury.2', 'Injury.3', 'Injury.4', 'Injury.5', 'Injury.6', 'Injury.7'), sep = ' and ') %>%
  mutate(Injury.1.Start = as.Date(Injury.1) - months(6),
         Injury.2.Start = ifelse(is.na(Injury.2), NA, Injury.1),
         Injury.3.Start = ifelse(is.na(Injury.3), NA, Injury.2),
         Injury.4.Start = ifelse(is.na(Injury.4), NA, Injury.3),
         Injury.5.Start = ifelse(is.na(Injury.4), NA, Injury.4),
         Injury.6.Start = ifelse(is.na(Injury.4), NA, Injury.5),
         Injury.7.Start = ifelse(is.na(Injury.4), NA, Injury.6)) %>%
  separate(Mechanism, c('Injury.1.Mech', 'Injury.2.Mech', 'Injury.3.Mech', 'Injury.4.Mech', 'Injury.5.Mech', 'Injury.6.Mech', 'Injury.7.Mech'), sep = ' and ') %>%
  separate(Injury, c('Injury.1.Diagnosis', 'Injury.2.Diagnosis', 'Injury.3.Diagnosis', 'Injury.4.Diagnosis', 'Injury.5.Diagnosis', 'Injury.6.Diagnosis', 'Injury.7.Diagnosis'), sep = ' and ') %>%
  separate(Time.Injured, c('Injury.1.Time', 'Injury.2.Time', 'Injury.3.Time', 'Injury.4.Time', 'Injury.5.Time', 'Injury.6.Time', 'Injury.7.Time'), sep = ' and ')
```

```{r}
#merges the last_injury_S to the performance_S_nordic by anon_id
merge_performance_L <- merge(last_injury_L, performance_L_nordic, by = c('anon_id'), all = TRUE)

#creates a variable called Group that groups based on date within injury intervals and outputs 'After' if the date is after all injuries, and then these are omitted
merge_performance_L <- merge_performance_L %>%
  mutate(Trend = ifelse(Trend == 'Neutral', 0, ifelse(Trend == 'Up', 1, -1)),
         Group = case_when(
    is.na(Injury.1) | Date < Injury.1.Start ~ '0',
    !is.na(Injury.1) & Date >= Injury.1.Start & Date <= Injury.1 ~ '1',
    !is.na(Injury.2) & Date >= Injury.2.Start & Date <= Injury.2 ~ '2',
    !is.na(Injury.3) & Date >= Injury.3.Start & Date <= Injury.3 ~ '3',
    !is.na(Injury.4) & Date >= Injury.4.Start & Date <= Injury.4 ~ '4',
    !is.na(Injury.5) & Date >= Injury.5.Start & Date <= Injury.5 ~ '5',
    !is.na(Injury.6) & Date >= Injury.6.Start & Date <= Injury.6 ~ '6',
    !is.na(Injury.7) & Date >= Injury.7.Start & Date <= Injury.7 ~ '7',
    TRUE ~ 'After')) %>%
  filter(Group != 'After')

#condenses observations based on group and player summarizing means of variables of interest
merge_performance_L <- merge_performance_L %>%
  mutate(Injury = case_when(
    Group == 0 ~ 'None',
    Group == 1 ~ Injury.1.Diagnosis,
    Group == 2 ~ Injury.2.Diagnosis,
    Group == 3 ~ Injury.3.Diagnosis,
    Group == 4 ~ Injury.4.Diagnosis,
    Group == 5 ~ Injury.1.Diagnosis,
    Group == 6 ~ Injury.2.Diagnosis,
    Group == 7 ~ Injury.3.Diagnosis,
    TRUE ~ 'After'
  )) %>%
  group_by(anon_id, Group, Injury) %>%
  summarise(Bodyweight.kg = mean(Athlete.Bodyweight..kg., na.rm = TRUE),
            Maximum.Force = mean(Maximum.Force, na.rm = TRUE),
            Average.Force = mean(Average.Force, na.rm = TRUE),
            Impulse = mean(Impulse, na.rm = TRUE),
            Nordic.MEAN.Imbalance = mean(Nordic.MEAN.Imbalance, na.rm = TRUE),
            Nordic.MAX.Imbalance = mean(Nordic.MAX.Imbalance, na.rm = TRUE),
            Trend = mean(Trend, na.rm = TRUE),
            Maximum.Nordic.Bilateral.Mean = mean(Maximum.Nordic.Bilateral.Mean, na.rm = TRUE),
            Relative.Maximum.Nordic.Bilateral.Mean = mean(Relative.Maximum.Nordic.Bilateral.Mean, na.rm = TRUE), .groups = 'drop') %>%
  mutate(Was.Injured = ifelse(Group == 1 | Group == 2 | Group == 3 | Group == 4 | Group == 5 | Group == 6 | Group == 7, 'Yes', Group))
```

```{r}
#creates a boxplot of maximum relative bilateral force across the soccer players
ggplot(merge_performance_L, aes(x = Relative.Maximum.Nordic.Bilateral.Mean, y = Was.Injured)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of Maximum Relative Bilateral Force Across Lacrosse Players',
       y = 'Was the Player Injured',
       x = 'Maximum Relative Bilateral Force (N / kg)') +
  theme_bw()
```

**4. Volleyball**
```{r}
#selects variables of interest, filters for lower body injuries, and gets rid of duplicate observations
incident_v <- Incident_V %>%
  filter(Body.Part %in% lower_body) %>%
  select("anon_id", "Position", "Date.of.Injury...Onset.of.symptoms", "Side", "Body.Part", "Tissue.Type", "Pathology.Type", "OSICS14.Code", "OSICS10.Code", "OSICS10.Diagnosis", "Final.Diagnosis", "Result.of.Sport.Participation", "Recurrence.of.Injury", "Injury.Prognosis", "General.Mechanism", "Specific.Mechanism", "FinalDiagnosisIncidentDate", "Total.Time.Injured", "Season.") %>%
  group_by(anon_id, Date.of.Injury...Onset.of.symptoms) %>%
  mutate(Total.Time.Injured = sum(Total.Time.Injured, na.rm = TRUE),
         Date = as.Date(Date.of.Injury...Onset.of.symptoms, format = '%m/%d/%Y'),
         Season. = ifelse(Season. == 'Pre-Season' | Season. == 'Summer Workouts' | Season. == 'Post-Season', 'Off-Season', Season.)) %>%
  ungroup() %>%
  group_by(across(everything())) %>%
  summarise(.groups = 'drop')
```

```{r, warning = FALSE}
#creates a dataset from the incident report that separates out all the dates for lower body injuries to classify observations based on their relation to lower body injuries: within 6 months prior to first injury, between first and second injury, ect.
last_injury_V <- incident_v %>%
  arrange(Date) %>%
  group_by(anon_id) %>%
  summarize(Dates.Final = paste0(Date, collapse = " and "),
            Mechanism = paste0(General.Mechanism, collapse = " and "),
            Injury = paste0(Final.Diagnosis, collapse = " and "),
            Time.Injured = paste0(Total.Time.Injured, collapse = " and ")) %>%
  separate(Dates.Final, c('Injury.1', 'Injury.2', 'Injury.3', 'Injury.4', 'Injury.5', 'Injury.6', 'Injury.7'), sep = ' and ') %>%
  mutate(Injury.1.Start = as.Date(Injury.1) - months(6),
         Injury.2.Start = ifelse(is.na(Injury.2), NA, Injury.1),
         Injury.3.Start = ifelse(is.na(Injury.3), NA, Injury.2),
         Injury.4.Start = ifelse(is.na(Injury.4), NA, Injury.3),
         Injury.5.Start = ifelse(is.na(Injury.4), NA, Injury.4),
         Injury.6.Start = ifelse(is.na(Injury.4), NA, Injury.5),
         Injury.7.Start = ifelse(is.na(Injury.4), NA, Injury.6)) %>%
  separate(Mechanism, c('Injury.1.Mech', 'Injury.2.Mech', 'Injury.3.Mech', 'Injury.4.Mech', 'Injury.5.Mech', 'Injury.6.Mech', 'Injury.7.Mech'), sep = ' and ') %>%
  separate(Injury, c('Injury.1.Diagnosis', 'Injury.2.Diagnosis', 'Injury.3.Diagnosis', 'Injury.4.Diagnosis', 'Injury.5.Diagnosis', 'Injury.6.Diagnosis', 'Injury.7.Diagnosis'), sep = ' and ') %>%
  separate(Time.Injured, c('Injury.1.Time', 'Injury.2.Time', 'Injury.3.Time', 'Injury.4.Time', 'Injury.5.Time', 'Injury.6.Time', 'Injury.7.Time'), sep = ' and ')
```

```{r}
#merges the last_injury_S to the performance_S_nordic by anon_id
merge_performance_V <- merge(last_injury_V, performance_V_nordic, by = c('anon_id'), all = TRUE)

#creates a variable called Group that groups based on date within injury intervals and outputs 'After' if the date is after all injuries, and then these are omitted
merge_performance_V <- merge_performance_V %>%
  mutate(Trend = ifelse(Trend == 'Neutral', 0, ifelse(Trend == 'Up', 1, -1)),
         Group = case_when(
    is.na(Injury.1) | Date < Injury.1.Start ~ '0',
    !is.na(Injury.1) & Date >= Injury.1.Start & Date <= Injury.1 ~ '1',
    !is.na(Injury.2) & Date >= Injury.2.Start & Date <= Injury.2 ~ '2',
    !is.na(Injury.3) & Date >= Injury.3.Start & Date <= Injury.3 ~ '3',
    !is.na(Injury.4) & Date >= Injury.4.Start & Date <= Injury.4 ~ '4',
    !is.na(Injury.5) & Date >= Injury.5.Start & Date <= Injury.5 ~ '5',
    !is.na(Injury.6) & Date >= Injury.6.Start & Date <= Injury.6 ~ '6',
    !is.na(Injury.7) & Date >= Injury.7.Start & Date <= Injury.7 ~ '7',
    TRUE ~ 'After')) %>%
  filter(Group != 'After')

#condenses observations based on group and player summarizing means of variables of interest
merge_performance_V <- merge_performance_V %>%
  mutate(Injury = case_when(
    Group == 0 ~ 'None',
    Group == 1 ~ Injury.1.Diagnosis,
    Group == 2 ~ Injury.2.Diagnosis,
    Group == 3 ~ Injury.3.Diagnosis,
    Group == 4 ~ Injury.4.Diagnosis,
    Group == 5 ~ Injury.1.Diagnosis,
    Group == 6 ~ Injury.2.Diagnosis,
    Group == 7 ~ Injury.3.Diagnosis,
    TRUE ~ 'After'
  )) %>%
  group_by(anon_id, Group, Injury) %>%
  summarise(Bodyweight.kg = mean(Athlete.Bodyweight..kg., na.rm = TRUE),
            Maximum.Force = mean(Maximum.Force, na.rm = TRUE),
            Average.Force = mean(Average.Force, na.rm = TRUE),
            Impulse = mean(Impulse, na.rm = TRUE),
            Nordic.MEAN.Imbalance = mean(Nordic.MEAN.Imbalance, na.rm = TRUE),
            Nordic.MAX.Imbalance = mean(Nordic.MAX.Imbalance, na.rm = TRUE),
            Trend = mean(Trend, na.rm = TRUE),
            Maximum.Nordic.Bilateral.Mean = mean(Maximum.Nordic.Bilateral.Mean, na.rm = TRUE),
            Relative.Maximum.Nordic.Bilateral.Mean = mean(Relative.Maximum.Nordic.Bilateral.Mean, na.rm = TRUE), .groups = 'drop') %>%
  mutate(Was.Injured = ifelse(Group == 1 | Group == 2 | Group == 3 | Group == 4 | Group == 5 | Group == 6 | Group == 7, 'Yes', Group))
```

```{r}
#creates a boxplot of maximum relative bilateral force across the soccer players
ggplot(merge_performance_V, aes(x = Relative.Maximum.Nordic.Bilateral.Mean, y = Was.Injured)) +
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of Maximum Relative Bilateral Force Across Lacrosse Players',
       y = 'Was the Player Injured',
       x = 'Maximum Relative Bilateral Force (N / kg)') +
  theme_bw()
```

```{r}
#creating a boxplot displaying distribution of relative maximum bilateral mean(different variable) in those who experienced lower body injury vs those that did not
ggplot(data = performance_B_nordic %>% filter(Position == 'Forward'), aes(x = Maximum.Force, y = LB)) + 
  geom_boxplot(fill = '#CFB87C', color = 'black') + 
  labs(title = 'Distribution of Maximum Force vs Lower Body Injury (All Time)',
       y = 'Did Player Suffer Lower Body Injury',
       x = 'Maximum Force (N)',
       caption = 'Womens Basketball Forwards') +
  theme_bw()
```







#MORE TREND EXPLORING 
```{r}
#recurence of injuries over time in soccer + basketball trends
recurrence_trend <- all_incident %>%
  filter(Sport %in% c("Soccer", "Basketball")) %>%
  group_by(Sport, Month, Recurrence.of.Injury) %>%
  summarise(Injuries = n(), .groups = "drop")

ggplot(recurrence_trend, aes(x = Month, y = Injuries, color = Recurrence.of.Injury)) +
  geom_line(size = 1) +
  facet_wrap(~Sport, scales = "free_y") +
  labs(title = "Injury Recurrence Over Time",
       x = "Month",
       y = "Number of Injuries") +
  theme_minimal()
```

```{r}
#trends of HSI in lacrosse + soccer
incident_S$HSI <- ifelse(incident_S$OSICS14.Code %in% c("TM1","TMB","TMS"),1,0)
sum(incident_S$HSI)

hsi_trend <- all_incident %>%
  filter(HSI == "1") %>%
  group_by(Month) %>%
  summarise(HSI_Count = n(), .groups = "drop")

ggplot(hsi_trend, aes(x = Month, y = HSI_Count, color = Sport)) +
  geom_line(size = 1.2) +
  labs(title = "HSI Trend in Soccer and Lacrosse",
       x = "Month",
       y = "HSI Injuries") +
  theme_minimal()
```

```{r}
#trends for ACL injury in volleyball
Incident_V <- read.csv("~/T2P2-data-analysis-2025/data-sets/Incident Report WVB.csv")
#ACL injury (most intense LB injury)
incident_V$ACL <- ifelse(incident_V$OSICS14.Code %in% c("KL1","KLA"),1,0)
sum(incident_V$ACL)

acl_volleyball <- incident_V %>%
  filter(Sport == "Volleyball", ACL== "1") %>%
  group_by(Month)

ggplot(acl_volleyball, aes(x = Month, y = ACL)) +
  geom_line(color = "darkred", size = 1.2) +
  labs(title = "ACL Injury Trend in Volleyball",
       x = "Month",
       y = "ACL Injuries") +
  theme_minimal()
```

#Specfic Player Trend Exploration
-figure out best way to do this 
```{r}
id_48 <- all_IMTP_incident %>%
  filter(anon_id == 'ID_48') %>%
  arrange(Date.x)

ggplot(id_48, aes(x = Date.x, y = Peak.Vertical.Force..N.)) + 
  geom_line() + 
 # geom_vline(xintercept = as.Date('2023-08-12'), color = 'red') + 
  scale_x_date(limits = as.Date(c('2023-01-12', '2023-08-12')),
               date_breaks = '3 months') +
  labs(title = 'Player ID_48 Peak.Vertical.Force Trend Before ACL Rupture',
       x = 'Date',
       y = 'DSI') + 
  theme_bw()
```












